{"version":3,"file":"blocks/checkout.js","mappings":";;;;;;;;;;;;;;;;;;AAAA,YAAY;;AAAA;AAEuC;AACX;AAExC,MAAMK,aAAa,GAAGA,CAAA,KAAM;EACxB;EACA,MAAMC,MAAM,GAAGC,MAAM,CAACD,MAAM;EAC5B,MAAME,EAAE,GAAGD,MAAM,CAACC,EAAE;;EAEpB;EACA,MAAM,CAACC,SAAS,EAAEC,YAAY,CAAC,GAAGT,+CAAQ,CAAC,EAAE,CAAC;EAC9C,MAAM,CAACU,oBAAoB,EAAEC,uBAAuB,CAAC,GAAGX,+CAAQ,CAAC;IAC7DY,GAAG,EAAEC,SAAS;IACdC,KAAK,EAAED,SAAS;IAChBE,MAAM,EAAEF;EACZ,CAAC,CAAC;EACF,MAAM,CAACG,iBAAiB,EAAEC,oBAAoB,CAAC,GAAGjB,+CAAQ,CAAC,EAAE,CAAC;EAC9D,MAAM,CAACkB,WAAW,EAAEC,cAAc,CAAC,GAAGnB,+CAAQ,CAAC,KAAK,CAAC;EACrD,MAAM,CAACoB,SAAS,EAAEC,YAAY,CAAC,GAAGrB,+CAAQ,CAAC,KAAK,CAAC;EACjD,MAAM,CAACsB,WAAW,EAAEC,cAAc,CAAC,GAAGvB,+CAAQ,CAAC,IAAI,CAAC;EACpD,MAAM,CAACwB,eAAe,EAAEC,kBAAkB,CAAC,GAAGzB,+CAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAAC0B,eAAe,EAAEC,kBAAkB,CAAC,GAAG3B,+CAAQ,CAAC,IAAI,CAAC;EAC5D,MAAM,CAAC4B,eAAe,EAAEC,kBAAkB,CAAC,GAAG7B,+CAAQ,CAAC,KAAK,CAAC;EAC7D,MAAM,CAAC8B,kBAAkB,EAAEC,qBAAqB,CAAC,GAAG/B,+CAAQ,CAAC,KAAK,CAAC;EACnE,MAAM,CAACgC,SAAS,EAAEC,YAAY,CAAC,GAAGjC,+CAAQ,CAAC,CAAC,CAAC;EAC7C,MAAM,CAACkC,UAAU,EAAEC,aAAa,CAAC,GAAGnC,+CAAQ,CAAC,CAAC,CAAC,EAAC;EAChD,MAAM,CAACoC,sBAAsB,EAAEC,yBAAyB,CAAC,GAAGrC,+CAAQ,CAAC,KAAK,CAAC;EAC3E,MAAM,CAACsC,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGvC,+CAAQ,CAAC,KAAK,CAAC;EACzE,MAAM,CAACwC,qBAAqB,EAAEC,wBAAwB,CAAC,GAAGzC,+CAAQ,CAAC,EAAE,CAAC;;EAEtE;EACA,MAAM0C,YAAY,GAAGxC,6CAAM,CAAC,IAAI,CAAC;EACjC,MAAMyC,kBAAkB,GAAGzC,6CAAM,CAAC,IAAI,CAAC;EACvC,MAAM0C,iBAAiB,GAAG1C,6CAAM,CAAC,IAAI,CAAC;EACtC,MAAM2C,QAAQ,GAAG3C,6CAAM,CAAC,IAAI,CAAC;;EAE7B;EACA,MAAM4C,MAAM,GAAGC,QAAQ,CAACC,eAAe,CAACC,IAAI,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,IAAI,IAAI;EAClE,MAAMC,UAAU,GAAGL,MAAM,KAAK,IAAI,GAAG,kBAAkB,GAAG,cAAc;EACxE,MAAMM,kBAAkB,GAAGN,MAAM,KAAK,IAAI,GAAG,0BAA0B,GAAG,0BAA0B;;EAEpG;EACA,MAAMO,YAAY,GAAGA,CAAA,KAAM;IACvBN,QAAQ,CAACO,MAAM,GAAG,yEAAyE;IAC3FP,QAAQ,CAACO,MAAM,GAAG,0EAA0E;IAE5F3C,uBAAuB,CAAC;MACpBC,GAAG,EAAEC,SAAS;MACdC,KAAK,EAAED,SAAS;MAChBE,MAAM,EAAEF;IACZ,CAAC,CAAC;IACFI,oBAAoB,CAAC,EAAE,CAAC;EAC5B,CAAC;;EAED;EACA,MAAMsC,qBAAqB,GAAIC,CAAC,IAAK;IACjC,IACIC,uBAAuB,CAAC,CAAC,KACxB/C,oBAAoB,CAACE,GAAG,KAAKC,SAAS,IACnCH,oBAAoB,CAACI,KAAK,KAAKD,SAAS,IACxCH,oBAAoB,CAACK,MAAM,KAAKF,SAAS,CAAC,EAChD;MACE2C,CAAC,CAACE,cAAc,CAAC,CAAC;MAClBF,CAAC,CAACG,eAAe,CAAC,CAAC;MAEnB,IAAI7B,kBAAkB,EAAE;QACpBvB,EAAE,CAACqD,IAAI,CAACC,QAAQ,CAAC,eAAe,CAAC,CAACC,oCAAoC,CAAC,aAAa,CAAC;QACrF/B,qBAAqB,CAAC,KAAK,CAAC;QAC5B;MACJ;MAEAgC,KAAK,CAACjB,MAAM,KAAK,IAAI,GAAG,6CAA6C,GAAG,wCAAwC,CAAC;MACjHvC,EAAE,CAACqD,IAAI,CAACC,QAAQ,CAAC,eAAe,CAAC,CAACC,oCAAoC,CAAC,aAAa,CAAC;MACrF/B,qBAAqB,CAAC,IAAI,CAAC;MAC3B,OAAO,KAAK;IAChB;EACJ,CAAC;;EAED;EACA,MAAM0B,uBAAuB,GAAGA,CAAA,KAAM;IAClC;IACA,MAAMO,SAAS,GAAG,CACd,oCAAoC,EACpC,kCAAkC,EAClC,gDAAgD,EAChD,6CAA6C,CAChD;IAED,KAAK,MAAMC,QAAQ,IAAID,SAAS,EAAE;MAC9B,MAAME,UAAU,GAAGnB,QAAQ,CAACoB,aAAa,CAACF,QAAQ,CAAC;MACnD,IAAIC,UAAU,EAAE;QACZ,IAAIA,UAAU,CAACE,IAAI,KAAK,OAAO,IAAIF,UAAU,CAACG,OAAO,EAAE;UACnD,OAAO,IAAI;QACf,CAAC,MAAM,IAAIH,UAAU,CAACE,IAAI,KAAK,QAAQ,EAAE;UACrC,OAAO,IAAI;QACf;MACJ;IACJ;;IAEA;IACA,IAAI,OAAO/D,MAAM,KAAK,WAAW,EAAE;MAC/B,MAAMiE,cAAc,GAAGjE,MAAM,CAAC,wCAAwC,CAAC,CAACkE,GAAG,CAAC,CAAC;MAC7E,IAAID,cAAc,IAAIA,cAAc,CAACE,QAAQ,CAAC,OAAO,CAAC,EAAE;QACpD,OAAO,IAAI;MACf;IACJ;IAEA,OAAO,KAAK;EAChB,CAAC;;EAED;EACA,MAAMC,wBAAwB,GAAGA,CAAA,KAAM;IACnC,IAAI,OAAOpE,MAAM,KAAK,WAAW,EAAE;MAC/B,MAAMiE,cAAc,GAAGjE,MAAM,CAAC,wCAAwC,CAAC,CAACkE,GAAG,CAAC,CAAC,IAAI,EAAE;MACnF,OAAOD,cAAc;IACzB;IACA,OAAO,EAAE;EACb,CAAC;;EAED;EACA,MAAMI,uBAAuB,GAAIC,eAAe,IAAK;IACjD,MAAMC,aAAa,GAAG7B,QAAQ,CAAC8B,cAAc,CAACF,eAAe,CAAC;IAC9D,IAAIC,aAAa,EAAE;MACf,IAAIA,aAAa,CAACR,IAAI,KAAK,OAAO,IAAIQ,aAAa,CAACP,OAAO,EAAE;QACzD,OAAO,IAAI;MACf,CAAC,MAAM,IAAIO,aAAa,CAACR,IAAI,KAAK,QAAQ,EAAE;QACxC,OAAO,IAAI;MACf;IACJ;IACA,OAAO,KAAK;EAChB,CAAC;;EAED;EACA,MAAMU,2BAA2B,GAAGA,CAAA,KAAM;IACtC,MAAMd,SAAS,GAAG,CACd,kBAAkB,EAClB,6CAA6C,EAC7C,kBAAkB,EAClB,+BAA+B,EAC/B,kBAAkB,CACrB;IAED,KAAK,MAAMC,QAAQ,IAAID,SAAS,EAAE;MAC9B,MAAMe,OAAO,GAAGhC,QAAQ,CAACoB,aAAa,CAACF,QAAQ,CAAC;MAChD,IAAIc,OAAO,EAAE;QACT,OAAOA,OAAO;MAClB;IACJ;IAEA,OAAO,IAAI;EACf,CAAC;;EAED;EACA,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;IAC9B;IACA,MAAMd,UAAU,GAAGnB,QAAQ,CAACoB,aAAa,CAAC,oCAAoC,CAAC;IAC/E,IAAID,UAAU,EAAE;MACZ;MACA,MAAMe,KAAK,GAAGf,UAAU,CAACgB,OAAO,CAAC,OAAO,CAAC;MACzC,OAAOD,KAAK;IAChB;IACA,OAAO,IAAI;EACf,CAAC;;EAED;EACA,MAAME,qCAAqC,GAAGA,CAAA,KAAM;IAChD,IAAI,CAACzC,YAAY,CAAC0C,OAAO,EAAE,OAAO,IAAI;;IAEtC;IACA,MAAMC,UAAU,GAAGL,mBAAmB,CAAC,CAAC;IACxC,IAAI,CAACK,UAAU,EAAE,OAAO,IAAI;;IAE5B;IACA,IAAIC,SAAS,GAAGvC,QAAQ,CAAC8B,cAAc,CAAC,wBAAwB,CAAC;;IAEjE;IACA,IAAI,CAACS,SAAS,EAAE;MACZA,SAAS,GAAGvC,QAAQ,CAAChD,aAAa,CAAC,KAAK,CAAC;MACzCuF,SAAS,CAACC,EAAE,GAAG,wBAAwB;MACvCD,SAAS,CAACE,KAAK,CAACC,SAAS,GAAG,MAAM;MAClCH,SAAS,CAACE,KAAK,CAACE,YAAY,GAAG,MAAM,EAAC;MACtCJ,SAAS,CAACE,KAAK,CAACG,UAAU,GAAG,MAAM,EAAC;MACpCL,SAAS,CAACE,KAAK,CAACI,WAAW,GAAG,MAAM,EAAC;;MAErC;MACA,IAAIP,UAAU,CAACQ,WAAW,EAAE;QACxBR,UAAU,CAACS,UAAU,CAACC,YAAY,CAACT,SAAS,EAAED,UAAU,CAACQ,WAAW,CAAC;MACzE,CAAC,MAAM;QACHR,UAAU,CAACS,UAAU,CAACE,WAAW,CAACV,SAAS,CAAC;MAChD;IACJ;IAEA,OAAOA,SAAS;EACpB,CAAC;;EAED;EACA,MAAMW,wCAAwC,GAAGA,CAAA,KAAM;IACnD,IAAI,CAACvD,YAAY,CAAC0C,OAAO,EAAE,OAAO,IAAI;;IAEtC;IACA,MAAMc,aAAa,GAAGpB,2BAA2B,CAAC,CAAC;IACnD,IAAI,CAACoB,aAAa,EAAE,OAAO,IAAI;;IAE/B;IACA,IAAIZ,SAAS,GAAGvC,QAAQ,CAAC8B,cAAc,CAAC,wBAAwB,CAAC;;IAEjE;IACA,IAAI,CAACS,SAAS,EAAE;MACZA,SAAS,GAAGvC,QAAQ,CAAChD,aAAa,CAAC,KAAK,CAAC;MACzCuF,SAAS,CAACC,EAAE,GAAG,wBAAwB;;MAEvC;MACA,IAAIW,aAAa,CAACL,WAAW,EAAE;QAC3BK,aAAa,CAACJ,UAAU,CAACC,YAAY,CAACT,SAAS,EAAEY,aAAa,CAACL,WAAW,CAAC;MAC/E,CAAC,MAAM;QACHK,aAAa,CAACJ,UAAU,CAACE,WAAW,CAACV,SAAS,CAAC;MACnD;IACJ;IAEA,OAAOA,SAAS;EACpB,CAAC;;EAED;EACA,MAAMa,sBAAsB,GAAIC,OAAO,IAAK;IACxC;IACA7D,wBAAwB,CAAC6D,OAAO,CAAC;;IAEjC;IACA,MAAMC,eAAe,GAAG,CACpB,kDAAkD,EAClD,cAAc,EACd,iDAAiD,EACjD,kBAAkB,EAClB,YAAY,CACf;IAED,IAAIC,WAAW,GAAG,KAAK;;IAEvB;IACA,KAAK,MAAMrC,QAAQ,IAAIoC,eAAe,EAAE;MACpC,MAAME,MAAM,GAAGxD,QAAQ,CAACoB,aAAa,CAACF,QAAQ,CAAC;MAC/C,IAAIsC,MAAM,EAAE;QACRD,WAAW,GAAG,IAAI;QAClBC,MAAM,CAACC,QAAQ,GAAGJ,OAAO;QAEzB,IAAIA,OAAO,EAAE;UACTG,MAAM,CAACf,KAAK,CAACiB,OAAO,GAAG,KAAK;UAC5BF,MAAM,CAACf,KAAK,CAACkB,MAAM,GAAG,aAAa;QACvC,CAAC,MAAM;UACHH,MAAM,CAACf,KAAK,CAACiB,OAAO,GAAG,EAAE;UACzBF,MAAM,CAACf,KAAK,CAACkB,MAAM,GAAG,EAAE;QAC5B;MAEJ;IACJ;;IAEA;IACA,IAAI,OAAOrG,MAAM,KAAK,WAAW,EAAE;MAC/B,KAAK,MAAM4D,QAAQ,IAAIoC,eAAe,EAAE;QACpC,MAAMM,OAAO,GAAGtG,MAAM,CAAC4D,QAAQ,CAAC;QAChC,IAAI0C,OAAO,CAACC,MAAM,EAAE;UAChBN,WAAW,GAAG,IAAI;UAElB,IAAIF,OAAO,EAAE;YACTO,OAAO,CAACE,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC;YAC9BF,OAAO,CAACG,QAAQ,CAAC,UAAU,CAAC;YAC5BH,OAAO,CAACI,GAAG,CAAC;cACRN,OAAO,EAAE,KAAK;cACdC,MAAM,EAAE;YACZ,CAAC,CAAC;UACN,CAAC,MAAM;YACHC,OAAO,CAACE,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC;YAC/BF,OAAO,CAACK,WAAW,CAAC,UAAU,CAAC;YAC/BL,OAAO,CAACI,GAAG,CAAC;cACRN,OAAO,EAAE,GAAG;cACZC,MAAM,EAAE;YACZ,CAAC,CAAC;UACN;QAEJ;MACJ;IACJ;EAEJ,CAAC;;EAED;EACA,MAAMO,oBAAoB,GAAGA,CAAA,KAAM;IAC/B,IAAI,CAACvE,YAAY,CAAC0C,OAAO,EAAE,OAAO,IAAI;;IAEtC;IACA,IAAIE,SAAS,GAAGvC,QAAQ,CAAC8B,cAAc,CAAC,uBAAuB,CAAC;;IAEhE;IACA,IAAI,CAACS,SAAS,EAAE;MACZA,SAAS,GAAGvC,QAAQ,CAAChD,aAAa,CAAC,KAAK,CAAC;MACzCuF,SAAS,CAACC,EAAE,GAAG,uBAAuB;MACtCxC,QAAQ,CAACmE,IAAI,CAAClB,WAAW,CAACV,SAAS,CAAC;IACxC;IAEA,OAAOA,SAAS;EACpB,CAAC;;EAED;EACA,MAAM6B,SAAS,GAAI7F,WAAW,IAAK;IAC/B,MAAM8F,MAAM,GAAG,CACX,IAAI9F,WAAW,GAAG,UAAU,GAAG,SAAS,aAAa,EACrD,IAAIA,WAAW,GAAG,UAAU,GAAG,SAAS,YAAY,EACpD,IAAIA,WAAW,GAAG,UAAU,GAAG,SAAS,UAAU,EAClD,IAAIA,WAAW,GAAG,UAAU,GAAG,SAAS,YAAY,EACpD,IAAIA,WAAW,GAAG,UAAU,GAAG,SAAS,OAAO,EAC/C,IAAIA,WAAW,GAAG,UAAU,GAAG,SAAS,QAAQ,EAChD,IAAIA,WAAW,GAAG,UAAU,GAAG,SAAS,WAAW,EACnD,gBAAgB,EAChB,QAAQ,CACX;IAED,IAAI+F,SAAS,GAAG,IAAI;IAEpBD,MAAM,CAACE,OAAO,CAAEC,KAAK,IAAK;MACtB,IAAI,OAAOlH,MAAM,KAAK,WAAW,EAAE;QAC/B,IAAIA,MAAM,CAACkH,KAAK,CAAC,CAAChD,GAAG,CAAC,CAAC,KAAK,EAAE,EAAE;UAC5B8C,SAAS,GAAG,KAAK;QACrB;MACJ;IACJ,CAAC,CAAC;IAEF,OAAOA,SAAS;EACpB,CAAC;;EAED;EACA,MAAMG,WAAW,GAAG,MAAAA,CAAA,KAAY;IAC5B,IAAI;MACA;MACA,IAAIjH,EAAE,IAAIA,EAAE,CAACqD,IAAI,IAAIrD,EAAE,CAACqD,IAAI,CAAC6D,MAAM,CAAC,eAAe,CAAC,EAAE;QAClD,MAAMC,QAAQ,GAAGnH,EAAE,CAACqD,IAAI,CAAC6D,MAAM,CAAC,eAAe,CAAC,CAACD,WAAW,CAAC,CAAC;;QAE9D;QACA,IAAIE,QAAQ,EAAE;UACV;;UAEA;UACA,MAAMC,KAAK,GAAGD,QAAQ,CAACE,MAAM,EAAEC,WAAW,IAAI,CAAC;UAC/C5F,YAAY,CAAC6F,MAAM,CAACC,UAAU,CAACJ,KAAK,CAAC,GAAG,GAAG,CAAC,EAAC;;UAE7C;UACA,MAAMK,WAAW,GAAGN,QAAQ,CAACO,WAAW,GAAG,KAAK;;UAEhD;;UAEA;UACA,MAAMC,WAAW,GAAGF,WAAW,GAAG,CAAC,GAAGA,WAAW,GAAG,CAAC;UACrD7F,aAAa,CAAC+F,WAAW,CAAC;UAE1B,OAAO;YACHP,KAAK,EAAEG,MAAM,CAACC,UAAU,CAACJ,KAAK,CAAC,GAAG,GAAG;YACrCQ,MAAM,EAAED,WAAW;YACnBE,QAAQ,EAAEV,QAAQ,CAACE,MAAM,EAAES,aAAa,IAAI;UAChD,CAAC;QACL;MACJ;;MAEA;MACA,IAAI,OAAOhI,MAAM,KAAK,WAAW,EAAE;QAC/B,MAAMiI,gBAAgB,GAAGjI,MAAM,CAAC,sBAAsB,CAAC;QACvD,IAAIiI,gBAAgB,CAAC1B,MAAM,EAAE;UACzB,MAAMe,KAAK,GACPG,MAAM,CAACC,UAAU,CACbO,gBAAgB,CACXC,IAAI,CAAC,CAAC,CACNC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC,CACxBA,OAAO,CAAC,GAAG,EAAE,GAAG,CACzB,CAAC,IAAI,CAAC;UACVvG,YAAY,CAAC0F,KAAK,CAAC;;UAEnB;UACA,IAAIQ,MAAM,GAAG,CAAC;UACd,MAAMM,WAAW,GAAGpI,MAAM,CAAC,2BAA2B,CAAC;UACvD,IAAIoI,WAAW,CAAC7B,MAAM,EAAE;YACpBuB,MAAM,GAAGL,MAAM,CAACC,UAAU,CAACU,WAAW,CAAClE,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;YAClDpC,aAAa,CAACgG,MAAM,CAAC;UACzB;UAEA,OAAO;YAAER,KAAK;YAAEQ,MAAM;YAAEC,QAAQ,EAAE;UAAM,CAAC;QAC7C;MACJ;MAEA,OAAO;QAAET,KAAK,EAAE,CAAC;QAAEQ,MAAM,EAAE,CAAC;QAAEC,QAAQ,EAAE;MAAM,CAAC;IACnD,CAAC,CAAC,OAAOM,KAAK,EAAE;MACZ,OAAO;QAAEf,KAAK,EAAE,CAAC;QAAEQ,MAAM,EAAE,CAAC;QAAEC,QAAQ,EAAE;MAAM,CAAC;IACnD;EACJ,CAAC;;EAED;EACA,MAAMO,eAAe,GAAG,MAAAA,CAAA,KAAY;IAEhC,IAAI,CAACjG,YAAY,CAAC0C,OAAO,EAAE;MACvB;IACJ;IAEA,IAAI,CAAC3B,uBAAuB,CAAC,CAAC,EAAE;MAC5B;IACJ;;IAEA;IACApC,YAAY,CAAC,IAAI,CAAC;;IAElB;IACA,MAAMuH,cAAc,GAAG3B,oBAAoB,CAAC,CAAC;;IAE7C;IACA,MAAM4B,MAAM,GAAGvH,WAAW,GAAG,UAAU,GAAG,SAAS;IACnD,MAAMwH,YAAY,GAAG;MACjBC,UAAU,EAAEhG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,aAAa,CAAC,EAAEG,KAAK,IAAI,EAAE;MACxEC,SAAS,EAAElG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,YAAY,CAAC,EAAEG,KAAK,IAAI,EAAE;MACtEE,OAAO,EAAEnG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,UAAU,CAAC,EAAEG,KAAK,IAAI,EAAE;MAClEG,SAAS,EAAEpG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,YAAY,CAAC,EAAEG,KAAK,IAAI,EAAE;MACtEI,IAAI,EAAErG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,OAAO,CAAC,EAAEG,KAAK,IAAI,EAAE;MAC5DK,QAAQ,EAAEtG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,WAAW,CAAC,EAAEG,KAAK,IAAI,EAAE;MACpEM,KAAK,EAAEvG,QAAQ,CAAC8B,cAAc,CAAC,GAAGgE,MAAM,QAAQ,CAAC,EAAEG,KAAK,IAAI,EAAE;MAC9DO,KAAK,EAAExG,QAAQ,CAAC8B,cAAc,CAAC,OAAO,CAAC,EAAEmE,KAAK,IAAI;IACtD,CAAC;;IAED;IACA,MAAMQ,MAAM,GAAG;MACXC,aAAa,EAAE,GAAGX,YAAY,CAACC,UAAU,IAAID,YAAY,CAACG,SAAS,EAAE,CAACS,IAAI,CAAC,CAAC;MAC5EC,gBAAgB,EAAEb,YAAY,CAACI,OAAO;MACtCU,gBAAgB,EAAEd,YAAY,CAACK,SAAS;MACxCU,kBAAkB,EAAEf,YAAY,CAACM,IAAI;MACrCU,kBAAkB,EAAEhB,YAAY,CAACO,QAAQ;MACzCU,cAAc,EAAEjB,YAAY,CAACQ,KAAK;MAClCU,cAAc,EAAElB,YAAY,CAACS;IACjC,CAAC;;IAED;IACA,MAAM7B,QAAQ,GAAG,MAAMF,WAAW,CAAC,CAAC;;IAEpC;IACA,MAAMyC,cAAc,GAAG;MACnB,GAAGT,MAAM;MACTU,WAAW,EAAExC,QAAQ,CAACC,KAAK;MAC3BwC,cAAc,EAAEzC,QAAQ,CAACU,QAAQ;MACjCgC,UAAU,EAAE,CAAC;MACbC,YAAY,EAAE3C,QAAQ,CAACS,MAAM,CAAE;IACnC,CAAC;;IAED;IACAmC,MAAM,CAACC,IAAI,CAACf,MAAM,CAAC,CAAClC,OAAO,CAAEkD,GAAG,IAAK;MACjC,IAAI,CAAChB,MAAM,CAACgB,GAAG,CAAC,EAAE,OAAOhB,MAAM,CAACgB,GAAG,CAAC;IACxC,CAAC,CAAC;IAEF,IAAI;MACA;MACA,IAAI,OAAOnK,MAAM,KAAK,WAAW,EAAE;QAE/B,IAAI,CAACC,MAAM,CAACmK,SAAS,EAAE;UACnBpJ,YAAY,CAAC,KAAK,CAAC;UACnB;QACJ;QAEA,MAAMqJ,QAAQ,GAAG,MAAMrK,MAAM,CAACsK,IAAI,CAAC;UAC/BvG,IAAI,EAAE,MAAM;UACZwG,GAAG,EAAEtK,MAAM,CAACmK,SAAS,CAACI,OAAO;UAC7BjH,IAAI,EAAE;YACFkH,MAAM,EAAE,+CAA+C;YACvDC,QAAQ,EAAEzK,MAAM,CAACmK,SAAS,CAACO,KAAK;YAChCxB,MAAM,EAAES;UACZ;QACJ,CAAC,CAAC;QAEF,IAAI,CAACS,QAAQ,EAAE;UACXrJ,YAAY,CAAC,KAAK,CAAC;UACnB;QACJ;;QAEA;QACA,IAAIuJ,GAAG;QACP,IAAI,OAAOF,QAAQ,KAAK,QAAQ,EAAE;UAC9BE,GAAG,GAAGF,QAAQ,CAACxH,KAAK,CAAC,GAAG,CAAC,CAAC+H,IAAI,CAAC,EAAE,CAAC,CAACzC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC;QAC5D,CAAC,MAAM,IAAI,OAAOkC,QAAQ,KAAK,QAAQ,EAAE;UACrCE,GAAG,GAAGF,QAAQ,CAACQ,QAAQ,CAAC,CAAC;QAC7B,CAAC,MAAM;UACH7J,YAAY,CAAC,KAAK,CAAC;UACnB;QACJ;;QAEA;QACA,MAAM8J,YAAY,GAAG,CAAC,IAAI,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI,CAAC;QAC7C,MAAMC,OAAO,GAAG,GAAGR,GAAG,SAASO,YAAY,CAAC3G,QAAQ,CAAC1B,MAAM,CAAC,GAAGA,MAAM,GAAG,IAAI,EAAE;;QAE9E;QACArC,YAAY,CAAC2K,OAAO,CAAC;;QAErB;QACAjK,cAAc,CAAC,IAAI,CAAC;;QAEpB;QACAkK,UAAU,CAAC,MAAM;UACbhK,YAAY,CAAC,KAAK,CAAC;QACvB,CAAC,EAAE,IAAI,CAAC;MACZ,CAAC,MAAM;QACHA,YAAY,CAAC,KAAK,CAAC;MACvB;IACJ,CAAC,CAAC,OAAOqH,KAAK,EAAE;MACZrH,YAAY,CAAC,KAAK,CAAC;IACvB;EACJ,CAAC;;EAED;EACA,MAAMiK,mBAAmB,GAAG,MAAOC,KAAK,IAAK;IACzC;IACA,MAAMC,eAAe,GAAGzI,QAAQ,CAACoB,aAAa,CAAC,gCAAgC,CAAC,EAAEsH,OAAO;IACzF,IAAID,eAAe,IAAIA,eAAe,CAACE,OAAO,CAACH,KAAK,CAACI,MAAM,CAAC,GAAG,CAAC,EAAE;MAC9D;IACJ;IAEA,MAAM/H,IAAI,GAAG2H,KAAK,CAAC3H,IAAI;;IAEvB;IACA7B,qBAAqB,CAAC,KAAK,CAAC;;IAE5B;IACA,IAAI6B,IAAI,CAACgI,cAAc,IAAIhI,IAAI,CAACgI,cAAc,KAAK,EAAE,EAAE;MACnD,IAAI,OAAOvL,MAAM,KAAK,WAAW,EAAE;QAC/B;QACA0D,KAAK,CAACH,IAAI,CAACgI,cAAc,CAAC;QAC1B;;QAEA;QACA;QACA;QACA;;QAEA;QACA;QACA;MACJ;MACA,OAAO,KAAK;IAChB;;IAEA;IACAjL,uBAAuB,CAAC;MACpBC,GAAG,EAAEgD,IAAI,CAACiI,kBAAkB;MAC5B/K,KAAK,EAAE8C,IAAI,CAACkI,oBAAoB;MAChC/K,MAAM,EAAE6C,IAAI,CAACmI;IACjB,CAAC,CAAC;;IAEF;IACA,IAAIC,aAAa,GAAGpI,IAAI,CAACmI,cAAc;IACvC,MAAME,QAAQ,GAAGlJ,QAAQ,CAAC8B,cAAc,CAAC,oBAAoB,CAAC;IAC9D,MAAMqH,iBAAiB,GAAGnJ,QAAQ,CAAC8B,cAAc,CAAC,8BAA8B,CAAC;IAEjF,IAAIoH,QAAQ,IAAIA,QAAQ,CAAC5H,OAAO,EAAE;MAC9B2H,aAAa,GAAGpI,IAAI,CAACiI,kBAAkB;IAC3C,CAAC,MAAM,IAAIK,iBAAiB,IAAIA,iBAAiB,CAAC7H,OAAO,EAAE;MACvD2H,aAAa,GAAGpI,IAAI,CAACkI,oBAAoB;IAC7C;;IAEA;IACA,MAAMK,WAAW,GAAG,GAAGvI,IAAI,CAACmI,cAAc,IAAInI,IAAI,CAACwI,4BAA4B,kBAC3EC,IAAI,CAACC,KAAK,CAAC,CAACN,aAAa,GAAGpI,IAAI,CAACmI,cAAc,IAAI,GAAG,CAAC,GAAG,GAAG,IAC7DnI,IAAI,CAACwI,4BAA4B,kBAAkB;IAEvDnL,oBAAoB,CAACkL,WAAW,CAAC;;IAEjC;IACApJ,QAAQ,CAACO,MAAM,GAAG,yBAAyB0I,aAAa,UAAU;;IAElE;IACA7K,cAAc,CAAC,KAAK,CAAC;;IAErB;IACA,MAAM0H,MAAM,GAAGvH,WAAW,GAAG,UAAU,GAAG,SAAS;IACnD,IAAIiL,QAAQ,GAAG,EAAE;IACjB,IAAIrD,OAAO,GAAG,EAAE;IAEhB,IAAItF,IAAI,CAAC4I,IAAI,IAAI,IAAI,EAAE;MACnBD,QAAQ,GAAG3I,IAAI,CAAC4I,IAAI,CAACtJ,KAAK,CAAC,GAAG,CAAC;MAC/BgG,OAAO,GAAGtF,IAAI,CAAC6I,IAAI;IACvB,CAAC,MAAM;MACHF,QAAQ,GAAG3I,IAAI,CAAC6I,IAAI,CAACvJ,KAAK,CAAC,GAAG,CAAC;IACnC;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACAH,QAAQ,CAACO,MAAM,GAAG,0BAA0BM,IAAI,CAAC2B,EAAE,UAAU;;IAE7D;IACAhF,EAAE,CAACqD,IAAI,CAACC,QAAQ,CAAC,eAAe,CAAC,CAACC,oCAAoC,CAAC,aAAa,CAAC;;IAErF;IACAqC,sBAAsB,CAAC,KAAK,CAAC,EAAC;EAClC,CAAC;;EAED;EACA,MAAMuG,aAAa,GAAGA,CAAA,KAAM;IACxB,IAAI,OAAOrM,MAAM,KAAK,WAAW,EAAE;MAC/B,MAAMsM,WAAW,GAAGtM,MAAM,CAAC,0BAA0B,CAAC;MACtDsM,WAAW,CAACC,KAAK,CAAC,CAAC;MAEnB,IAAI,CAACnJ,uBAAuB,CAAC,CAAC,EAAE;QAC5BkJ,WAAW,CAAC5F,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;MACtC,CAAC,MAAM;QACH,IAAIrC,uBAAuB,CAAC,oBAAoB,CAAC,EAAE;UAC/CiI,WAAW,CAACpE,IAAI,CAACvH,iBAAiB,CAAC;QACvC,CAAC,MAAM,IAAI0D,uBAAuB,CAAC,8BAA8B,CAAC,EAAE;UAChEiI,WAAW,CAACpE,IAAI,CAAC,EAAE,CAAC;QACxB,CAAC,MAAM;UACHoE,WAAW,CAACpE,IAAI,CAAC,EAAE,CAAC;QACxB;QACAoE,WAAW,CAAC5F,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC;MACvC;IACJ;EACJ,CAAC;;EAED;EACA,MAAM8F,yBAAyB,GAAIrG,QAAQ,IAAK;IAC5C,IAAI,OAAOnG,MAAM,KAAK,WAAW,EAAE;MAC/B,MAAMyM,gBAAgB,GAAGzM,MAAM,CAAC,cAAc,CAAC;MAE/C,IAAIyM,gBAAgB,CAAClG,MAAM,EAAE;QACzB,IAAIJ,QAAQ,EAAE;UACV;UACAsG,gBAAgB,CAACjG,IAAI,CAAC,UAAU,EAAE,IAAI,CAAC;UACvCiG,gBAAgB,CAAChG,QAAQ,CAAC,UAAU,CAAC;UACrCgG,gBAAgB,CAAC/F,GAAG,CAAC;YACjBN,OAAO,EAAE,KAAK;YACdC,MAAM,EAAE;UACZ,CAAC,CAAC;;UAEF;UACA,IAAI,CAACrG,MAAM,CAAC,yBAAyB,CAAC,CAACuG,MAAM,EAAE;YAC3C,MAAMmG,cAAc,GAChBjK,MAAM,KAAK,IAAI,GACT,iEAAiE,GACjE,0DAA0D;YAEpEgK,gBAAgB,CAACE,KAAK,CAClB,8EAA8ED,cAAc,QAChG,CAAC;UACL;QACJ,CAAC,MAAM;UACH;UACAD,gBAAgB,CAACjG,IAAI,CAAC,UAAU,EAAE,KAAK,CAAC;UACxCiG,gBAAgB,CAAC9F,WAAW,CAAC,UAAU,CAAC;UACxC8F,gBAAgB,CAAC/F,GAAG,CAAC;YACjBN,OAAO,EAAE,GAAG;YACZC,MAAM,EAAE;UACZ,CAAC,CAAC;;UAEF;UACArG,MAAM,CAAC,yBAAyB,CAAC,CAAC4M,MAAM,CAAC,CAAC;QAC9C;MACJ;IACJ;EACJ,CAAC;;EAED;EACA,MAAMC,mBAAmB,GAAGA,CAAA,KAAM;IAC9B;IACA,MAAMC,iBAAiB,GAAG1I,wBAAwB,CAAC,CAAC;IACpD,MAAM2I,OAAO,GAAG3J,uBAAuB,CAAC,CAAC;;IAEzC;IACA5B,kBAAkB,CAACuL,OAAO,CAAC;IAC3B3K,wBAAwB,CAAC0K,iBAAiB,CAAC;IAE3C,IAAIC,OAAO,EAAE;MACT;MACA,MAAM9H,SAAS,GAAGW,wCAAwC,CAAC,CAAC;MAC5D,IAAIX,SAAS,EAAE;QACX3D,kBAAkB,CAAC2D,SAAS,CAAC;MACjC;;MAEA;MACA,MAAM+H,YAAY,GAAGlI,qCAAqC,CAAC,CAAC;MAC5D,IAAIkI,YAAY,EAAE;QACd5L,kBAAkB,CAAC4L,YAAY,CAAC;MACpC;;MAEA;MACA7F,WAAW,CAAC,CAAC;;MAEb;MACA,MAAM8F,mBAAmB,GACrB5M,oBAAoB,CAACE,GAAG,KAAKC,SAAS,IACtCH,oBAAoB,CAACI,KAAK,KAAKD,SAAS,IACxCH,oBAAoB,CAACK,MAAM,KAAKF,SAAS;;MAE7C;MACAsF,sBAAsB,CAACmH,mBAAmB,CAAC;IAC/C,CAAC,MAAM;MACH;MACAnH,sBAAsB,CAAC,KAAK,CAAC;IACjC;EACJ,CAAC;;EAED;EACAlG,gDAAS,CAAC,MAAM;IACZ;IACAiN,mBAAmB,CAAC,CAAC;;IAErB;IACA,MAAMK,0BAA0B,GAAGA,CAAA,KAAM;MACrCL,mBAAmB,CAAC,CAAC;;MAErB;MACA7B,UAAU,CAAC6B,mBAAmB,EAAE,GAAG,CAAC;MACpC7B,UAAU,CAAC6B,mBAAmB,EAAE,GAAG,CAAC;IACxC,CAAC;IAED,IAAI,OAAO7M,MAAM,KAAK,WAAW,EAAE;MAC/B;MACAA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAACsG,EAAE,CAAC,kBAAkB,EAAED,0BAA0B,CAAC;;MAExE;MACAlN,MAAM,CAAC0C,QAAQ,CAAC,CAACyK,EAAE,CAAC,QAAQ,EAAE,gCAAgC,EAAED,0BAA0B,CAAC;;MAE3F;MACAlN,MAAM,CAAC0C,QAAQ,CAAC,CAACyK,EAAE,CAAC,QAAQ,EAAE,OAAO,EAAE,MAAM;QACzCnC,UAAU,CAAC6B,mBAAmB,EAAE,GAAG,CAAC;MACxC,CAAC,CAAC;IACN;;IAEA;IACA,MAAMO,UAAU,GAAGC,WAAW,CAACR,mBAAmB,EAAE,IAAI,CAAC;IACzD7B,UAAU,CAAC,MAAMsC,aAAa,CAACF,UAAU,CAAC,EAAE,IAAI,CAAC;;IAEjD;IACA,OAAO,MAAM;MACT,IAAI,OAAOpN,MAAM,KAAK,WAAW,EAAE;QAC/BA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAAC0G,GAAG,CAAC,kBAAkB,EAAEL,0BAA0B,CAAC;QACzElN,MAAM,CAAC0C,QAAQ,CAAC,CAAC6K,GAAG,CAAC,QAAQ,EAAE,gCAAgC,EAAEL,0BAA0B,CAAC;QAC5FlN,MAAM,CAAC0C,QAAQ,CAAC,CAAC6K,GAAG,CAAC,QAAQ,EAAE,OAAO,CAAC;MAC3C;MACAD,aAAa,CAACF,UAAU,CAAC;IAC7B,CAAC;EACL,CAAC,EAAE,CAAC/M,oBAAoB,CAAC,CAAC;;EAE1B;EACAT,gDAAS,CAAC,MAAM;IAEZ;IACA,IAAI,CAACuC,qBAAqB,CAACgC,QAAQ,CAAC,OAAO,CAAC,EAAE;MAE1C;MACA6G,UAAU,CAAC,MAAMlF,sBAAsB,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC;MACpDkF,UAAU,CAAC,MAAMlF,sBAAsB,CAAC,KAAK,CAAC,EAAE,GAAG,CAAC;IACxD;EACJ,CAAC,EAAE,CAAC3D,qBAAqB,CAAC,CAAC;;EAE3B;EACA;EACA;EACAvC,gDAAS,CAAC,MAAM;IACZ;IACA,MAAM4N,oBAAoB,GAAGA,CAAA,KAAM;MAC/B,IAAIjM,eAAe,EAAE;QACjB;QACA;QACA4F,WAAW,CAAC,CAAC;MACjB;IACJ,CAAC;;IAED;IACA,IAAIsG,WAAW;IACf,IAAIvN,EAAE,IAAIA,EAAE,CAACqD,IAAI,IAAIrD,EAAE,CAACqD,IAAI,CAACmK,SAAS,EAAE;MACpCD,WAAW,GAAGvN,EAAE,CAACqD,IAAI,CAACmK,SAAS,CAAC,MAAM;QAClC,MAAMC,WAAW,GAAGzN,EAAE,CAACqD,IAAI,CAAC6D,MAAM,CAAC,eAAe,CAAC,EAAED,WAAW,CAAC,CAAC;QAClE,IAAIwG,WAAW,EAAE;UACbH,oBAAoB,CAAC,CAAC;QAC1B;MACJ,CAAC,CAAC;IACN;;IAEA;IACA,IAAIjM,eAAe,EAAE;MACjB;MACA4F,WAAW,CAAC,CAAC;IACjB;;IAEA;IACA,OAAO,MAAM;MACT,IAAIsG,WAAW,EAAE;QACbA,WAAW,CAAC,CAAC;MACjB;IACJ,CAAC;EACL,CAAC,EAAE,CAAClM,eAAe,CAAC,CAAC;;EAErB;EACA3B,gDAAS,CAAC,MAAM;IACZ,IAAI2B,eAAe,EAAE;MACjB,MAAM0D,SAAS,GAAGW,wCAAwC,CAAC,CAAC;MAC5D,IAAIX,SAAS,EAAE;QACX3D,kBAAkB,CAAC2D,SAAS,CAAC;MACjC;MAEA,MAAM+H,YAAY,GAAGlI,qCAAqC,CAAC,CAAC;MAC5D,IAAIkI,YAAY,EAAE;QACd5L,kBAAkB,CAAC4L,YAAY,CAAC;MACpC;;MAEA;MACAX,aAAa,CAAC,CAAC;;MAEf;MACA,MAAMY,mBAAmB,GACrB5M,oBAAoB,CAACE,GAAG,KAAKC,SAAS,IACtCH,oBAAoB,CAACI,KAAK,KAAKD,SAAS,IACxCH,oBAAoB,CAACK,MAAM,KAAKF,SAAS;MAE7CwB,yBAAyB,CAACiL,mBAAmB,CAAC;MAC9CT,yBAAyB,CAACS,mBAAmB,CAAC;IAClD;EACJ,CAAC,EAAE,CAAC1L,eAAe,EAAEZ,iBAAiB,CAAC,CAAC;;EAExC;EACAf,gDAAS,CAAC,MAAM;IACZ0C,kBAAkB,CAACyC,OAAO,GAAGkG,mBAAmB;IAChDhL,MAAM,CAAC2N,gBAAgB,CAAC,SAAS,EAAE3C,mBAAmB,CAAC;IAEvD,OAAO,MAAM;MACThL,MAAM,CAAC4N,mBAAmB,CAAC,SAAS,EAAE5C,mBAAmB,CAAC;MAC1D3I,kBAAkB,CAACyC,OAAO,GAAG,IAAI;IACrC,CAAC;EACL,CAAC,EAAE,CAAC9D,WAAW,CAAC,CAAC;;EAEjB;EACArB,gDAAS,CAAC,MAAM;IACZ,MAAMkO,eAAe,GAAI3K,CAAC,IAAK;MAC3B,IAAIA,CAAC,CAACgH,GAAG,KAAK,QAAQ,IAAItJ,WAAW,EAAE;QACnCC,cAAc,CAAC,KAAK,CAAC;MACzB;IACJ,CAAC;IAED4B,QAAQ,CAACkL,gBAAgB,CAAC,SAAS,EAAEE,eAAe,CAAC;IAErD,OAAO,MAAM;MACTpL,QAAQ,CAACmL,mBAAmB,CAAC,SAAS,EAAEC,eAAe,CAAC;IAC5D,CAAC;EACL,CAAC,EAAE,CAACjN,WAAW,CAAC,CAAC;;EAEjB;EACAjB,gDAAS,CAAC,MAAM;IACZ,MAAMmO,kBAAkB,GAAI5K,CAAC,IAAK;MAC9B,IAAIX,QAAQ,CAACuC,OAAO,IAAI,CAACvC,QAAQ,CAACuC,OAAO,CAACiJ,QAAQ,CAAC7K,CAAC,CAAC8K,MAAM,CAAC,IAAIpN,WAAW,EAAE;QACzE;QACA,IAAIsC,CAAC,CAAC8K,MAAM,CAACC,SAAS,CAACF,QAAQ,CAAC,qBAAqB,CAAC,EAAE;UACpDlN,cAAc,CAAC,KAAK,CAAC;QACzB;MACJ;IACJ,CAAC;IAED4B,QAAQ,CAACkL,gBAAgB,CAAC,WAAW,EAAEG,kBAAkB,CAAC;IAE1D,OAAO,MAAM;MACTrL,QAAQ,CAACmL,mBAAmB,CAAC,WAAW,EAAEE,kBAAkB,CAAC;IACjE,CAAC;EACL,CAAC,EAAE,CAAClN,WAAW,CAAC,CAAC;;EAEjB;EACAjB,gDAAS,CAAC,MAAM;IACZ,MAAMuO,yBAAyB,GAAGA,CAAA,KAAM;MACpC,IAAI,OAAOnO,MAAM,KAAK,WAAW,EAAE;QAC/B,MAAMoO,aAAa,GAAGpO,MAAM,CAAC,+BAA+B,CAAC;QAE7DoO,aAAa,CAACC,IAAI,CAAC,CAAClE,GAAG,EAAEjD,KAAK,KAAK;UAC/BlH,MAAM,CAAC,IAAIkH,KAAK,CAAChC,EAAE,EAAE,CAAC,CAACoJ,MAAM,CAAC,YAAY;YACtC,IAAI,IAAI,CAAC3F,KAAK,KAAK,KAAK,IAAIvF,uBAAuB,CAAC,CAAC,EAAE;cACnDV,QAAQ,CAACO,MAAM,GAAG,yBAAyB5C,oBAAoB,CAACE,GAAG,UAAU;cAC7EP,MAAM,CAAC,0BAA0B,CAAC,CAAC0G,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC;YAC9D,CAAC,MAAM,IAAI,IAAI,CAACiC,KAAK,KAAK,eAAe,IAAIvF,uBAAuB,CAAC,CAAC,EAAE;cACpEV,QAAQ,CAACO,MAAM,GAAG,yBAAyB5C,oBAAoB,CAACI,KAAK,UAAU;cAC/ET,MAAM,CAAC,0BAA0B,CAAC,CAAC0G,GAAG,CAAC,SAAS,EAAE,OAAO,CAAC;YAC9D,CAAC,MAAM,IAAItD,uBAAuB,CAAC,CAAC,EAAE;cAClCV,QAAQ,CAACO,MAAM,GAAG,yBAAyB5C,oBAAoB,CAACK,MAAM,UAAU;cAChFV,MAAM,CAAC,0BAA0B,CAAC,CAAC0G,GAAG,CAAC,SAAS,EAAE,MAAM,CAAC;YAC7D;YAEAxG,EAAE,CAACqD,IAAI,CAACC,QAAQ,CAAC,eAAe,CAAC,CAACC,oCAAoC,CAAC,aAAa,CAAC;UACzF,CAAC,CAAC;QACN,CAAC,CAAC;MACN;IACJ,CAAC;IAED,IAAI,OAAOzD,MAAM,KAAK,WAAW,EAAE;MAC/BA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAACsG,EAAE,CAAC,kBAAkB,EAAEgB,yBAAyB,CAAC;IAC3E;IAEA,OAAO,MAAM;MACT,IAAI,OAAOnO,MAAM,KAAK,WAAW,EAAE;QAC/BA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAAC0G,GAAG,CAAC,kBAAkB,EAAEY,yBAAyB,CAAC;MAC5E;IACJ,CAAC;EACL,CAAC,EAAE,CAAC9N,oBAAoB,CAAC,CAAC;;EAE1B;EACAT,gDAAS,CAAC,MAAM;IACZ,MAAM2O,qBAAqB,GAAIpL,CAAC,IAAK;MACjCD,qBAAqB,CAACC,CAAC,CAAC;IAC5B,CAAC;IAED,IAAI,OAAOnD,MAAM,KAAK,WAAW,EAAE;MAC/BA,MAAM,CAAC,cAAc,CAAC,CAACmN,EAAE,CAAC,OAAO,EAAEoB,qBAAqB,CAAC;IAC7D;IAEA,OAAO,MAAM;MACT,IAAI,OAAOvO,MAAM,KAAK,WAAW,EAAE;QAC/BA,MAAM,CAAC,cAAc,CAAC,CAACuN,GAAG,CAAC,OAAO,EAAEgB,qBAAqB,CAAC;MAC9D;IACJ,CAAC;EACL,CAAC,EAAE,CAAClO,oBAAoB,CAAC,CAAC;;EAE1B;EACAT,gDAAS,CAAC,MAAM;IACZ,MAAM4O,kBAAkB,GAAGA,CAAA,KAAM;MAC7BxL,YAAY,CAAC,CAAC;IAClB,CAAC;IAED,IAAI,OAAOhD,MAAM,KAAK,WAAW,EAAE;MAC/BA,MAAM,CAAC,6BAA6B,CAAC,CAACmN,EAAE,CAAC,OAAO,EAAEqB,kBAAkB,CAAC;MACrExO,MAAM,CAAC,6BAA6B,CAAC,CAACmN,EAAE,CAAC,OAAO,EAAEqB,kBAAkB,CAAC;IACzE;IAEA,OAAO,MAAM;MACT,IAAI,OAAOxO,MAAM,KAAK,WAAW,EAAE;QAC/BA,MAAM,CAAC,6BAA6B,CAAC,CAACuN,GAAG,CAAC,OAAO,EAAEiB,kBAAkB,CAAC;QACtExO,MAAM,CAAC,6BAA6B,CAAC,CAACuN,GAAG,CAAC,OAAO,EAAEiB,kBAAkB,CAAC;MAC1E;IACJ,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA5O,gDAAS,CAAC,MAAM;IACZ,MAAM6O,mBAAmB,GAAGA,CAAA,KAAM;MAC9BzL,YAAY,CAAC,CAAC;MACd9C,EAAE,CAACqD,IAAI,CAACC,QAAQ,CAAC,eAAe,CAAC,CAACC,oCAAoC,CAAC,aAAa,CAAC;IACzF,CAAC;IAED,IAAI,OAAOzD,MAAM,KAAK,WAAW,EAAE;MAC/BA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAACsG,EAAE,CAAC,gBAAgB,EAAEsB,mBAAmB,CAAC;IACnE;IAEA,OAAO,MAAM;MACT,IAAI,OAAOzO,MAAM,KAAK,WAAW,EAAE;QAC/BA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAAC0G,GAAG,CAAC,gBAAgB,EAAEkB,mBAAmB,CAAC;MACpE;IACJ,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA7O,gDAAS,CAAC,MAAM;IACZ,OAAO,MAAM;MACTyC,YAAY,CAAC0C,OAAO,GAAG,KAAK;;MAE5B;MACA,IAAI,OAAO/E,MAAM,KAAK,WAAW,EAAE;QAC/BA,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAAC0G,GAAG,CAAC,kBAAkB,CAAC;QAC7CvN,MAAM,CAAC,gCAAgC,CAAC,CAACuN,GAAG,CAAC,QAAQ,CAAC;QACtDvN,MAAM,CAAC,cAAc,CAAC,CAACuN,GAAG,CAAC,OAAO,CAAC;QACnCvN,MAAM,CAAC,6BAA6B,CAAC,CAACuN,GAAG,CAAC,OAAO,CAAC;QAClDvN,MAAM,CAAC,6BAA6B,CAAC,CAACuN,GAAG,CAAC,OAAO,CAAC;QAClDvN,MAAM,CAAC0C,QAAQ,CAACmE,IAAI,CAAC,CAAC0G,GAAG,CAAC,gBAAgB,CAAC;MAC/C;;MAEA;MACA,IAAIjL,kBAAkB,CAACyC,OAAO,EAAE;QAC5B9E,MAAM,CAAC4N,mBAAmB,CAAC,SAAS,EAAEvL,kBAAkB,CAACyC,OAAO,CAAC;QACjEzC,kBAAkB,CAACyC,OAAO,GAAG,IAAI;MACrC;;MAEA;MACA,MAAME,SAAS,GAAGvC,QAAQ,CAAC8B,cAAc,CAAC,wBAAwB,CAAC;MACnE,IAAIS,SAAS,EAAE;QACXA,SAAS,CAAC2H,MAAM,CAAC,CAAC;MACtB;;MAEA;MACA,MAAMI,YAAY,GAAGtK,QAAQ,CAAC8B,cAAc,CAAC,wBAAwB,CAAC;MACtE,IAAIwI,YAAY,EAAE;QACdA,YAAY,CAACJ,MAAM,CAAC,CAAC;MACzB;;MAEA;MACA,MAAMrE,cAAc,GAAG7F,QAAQ,CAAC8B,cAAc,CAAC,uBAAuB,CAAC;MACvE,IAAI+D,cAAc,EAAE;QAChBA,cAAc,CAACqE,MAAM,CAAC,CAAC;MAC3B;IACJ,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;;EAEN;EACA,MAAM8B,iBAAiB,GAAGA,CAAA,KAAM;IAC5B,IAAI,CAACnN,eAAe,EAAE;MAClB,OAAO,IAAI;IACf;;IAEA;IACA,MAAMyL,YAAY,GAAG7L,eAAe,IAAI2D,qCAAqC,CAAC,CAAC;IAC/E,IAAI,CAACkI,YAAY,EAAE;MACf,OAAO,IAAI;IACf;;IAEA;IACA,IAAIA,YAAY,KAAK7L,eAAe,EAAE;MAClCC,kBAAkB,CAAC4L,YAAY,CAAC;IACpC;IAEA,OAAOlN,uDAAY,CACfJ,oDAAA;MACIqE,IAAI,EAAC,QAAQ;MACbmB,EAAE,EAAC,2BAA2B;MAC9ByJ,SAAS,EAAC,kCAAkC;MAC5CxJ,KAAK,EAAE;QACHyJ,OAAO,EAAE,cAAc;QACvBC,OAAO,EAAE,UAAU;QACnBC,eAAe,EAAE,SAAS;QAC1BC,KAAK,EAAE,OAAO;QACdC,MAAM,EAAE,MAAM;QACdC,YAAY,EAAE,KAAK;QACnB5I,MAAM,EAAE,SAAS;QACjB6I,QAAQ,EAAE,MAAM;QAChB9J,SAAS,EAAE;MACf,CAAE;MACF+J,OAAO,EAAEA,CAAA,KAAM;QACX7G,eAAe,CAAC,CAAC;MACrB;IAAE,GAEDjI,oBAAoB,CAACK,MAAM,GAAGoC,UAAU,GAAGC,kBACxC,CAAC,EACTiK,YACJ,CAAC;EACL,CAAC;;EAED;EACA,MAAMoC,WAAW,GAAGA,CAAA,KAAM;IACtB,IAAI,CAACvO,WAAW,EAAE,OAAO,IAAI;IAE7B,MAAM0H,cAAc,GAAG3B,oBAAoB,CAAC,CAAC;IAC7C,IAAI,CAAC2B,cAAc,EAAE,OAAO,IAAI;IAEhC,OAAOzI,uDAAY,CACfJ,oDAAA;MACIwF,EAAE,EAAC,SAAS;MACZyJ,SAAS,EAAC,qBAAqB;MAC/BxJ,KAAK,EAAE;QACHkK,QAAQ,EAAE,OAAO;QACjBC,GAAG,EAAE,CAAC;QACNC,IAAI,EAAE,CAAC;QACPC,KAAK,EAAE,CAAC;QACRC,MAAM,EAAE,CAAC;QACTX,eAAe,EAAE,oBAAoB;QACrCF,OAAO,EAAE,MAAM;QACfc,cAAc,EAAE,QAAQ;QACxBC,UAAU,EAAE,QAAQ;QACpBC,MAAM,EAAE;MACZ;IAAE,GAEFlQ,oDAAA;MACImQ,GAAG,EAAErN,QAAS;MACdmM,SAAS,EAAC,aAAa;MACvBxJ,KAAK,EAAE;QACH2J,eAAe,EAAE,OAAO;QACxBG,YAAY,EAAE,KAAK;QACnBa,SAAS,EAAE,gCAAgC;QAC3CC,KAAK,EAAE,KAAK;QACZC,QAAQ,EAAE,OAAO;QACjBC,SAAS,EAAE,MAAM;QACjBrB,OAAO,EAAE,MAAM;QACfsB,aAAa,EAAE,QAAQ;QACvBC,QAAQ,EAAE;MACd;IAAE,GAEFzQ,oDAAA;MACIiP,SAAS,EAAC,oBAAoB;MAC9BxJ,KAAK,EAAE;QACHyJ,OAAO,EAAE,MAAM;QACfc,cAAc,EAAE,eAAe;QAC/BC,UAAU,EAAE,QAAQ;QACpBd,OAAO,EAAE,WAAW;QACpBuB,YAAY,EAAE;MAClB;IAAE,GAEF1Q,oDAAA;MAAIyF,KAAK,EAAE;QAAEkL,MAAM,EAAE;MAAE;IAAE,GAAE5N,MAAM,KAAK,IAAI,GAAG,kBAAkB,GAAG,gBAAqB,CAAC,EACxF/C,oDAAA;MACIqE,IAAI,EAAC,QAAQ;MACb4K,SAAS,EAAC,mBAAmB;MAC7BxJ,KAAK,EAAE;QACHmL,UAAU,EAAE,MAAM;QAClBtB,MAAM,EAAE,MAAM;QACd3I,MAAM,EAAE,SAAS;QACjB6I,QAAQ,EAAE,MAAM;QAChBL,OAAO,EAAE,KAAK;QACd0B,UAAU,EAAE;MAChB,CAAE;MACFpB,OAAO,EAAEA,CAAA,KAAMrO,cAAc,CAAC,KAAK,CAAE;MACrC,cAAW;IAAO,GACrB,MAEO,CACP,CAAC,EACNpB,oDAAA;MACIiP,SAAS,EAAC,kBAAkB;MAC5BxJ,KAAK,EAAE;QACH0J,OAAO,EAAE,MAAM;QACfsB,QAAQ,EAAE,MAAM;QAChBK,IAAI,EAAE;MACV;IAAE,GAGDzP,SAAS,IACNrB,oDAAA;MACIiP,SAAS,EAAC,eAAe;MACzBxJ,KAAK,EAAE;QACH0J,OAAO,EAAE,MAAM;QACfC,eAAe,EAAE,SAAS;QAC1B2B,SAAS,EAAE;MACf;IAAE,GAEDhO,MAAM,KAAK,IAAI,GAAG,cAAc,GAAG,YACnC,CACR,EAGD/C,oDAAA;MACIwF,EAAE,EAAC,mBAAmB;MACtBC,KAAK,EAAE;QACHyJ,OAAO,EAAE7N,SAAS,GAAG,MAAM,GAAG,OAAO;QACrC6O,MAAM,EAAE7O,SAAS,GAAG,IAAI,GAAG;MAC/B;IAAE,GAEDZ,SAAS,IACNT,oDAAA;MACIgR,GAAG,EAAEvQ,SAAU;MACf+E,EAAE,EAAC,4BAA4B;MAC/BkH,IAAI,EAAC,mBAAmB;MACxBuE,SAAS,EAAC,KAAK;MACfxL,KAAK,EAAE;QACH4K,KAAK,EAAE,MAAM;QACba,MAAM,EAAE,OAAO;QACf5B,MAAM,EAAE;MACZ;IAAE,CACL,CAEJ,CACJ,CACJ,CACJ,CAAC,EACNzG,cACJ,CAAC;EACL,CAAC;;EAED;EACA,IAAIlH,eAAe,IAAIE,eAAe,EAAE;IACpC,OAAOzB,uDAAY,CACfJ,oDAAA;MACImQ,GAAG,EAAEtN,iBAAkB;MACvBoM,SAAS,EAAC,yBAAyB;MACnCxJ,KAAK,EAAE;QACHkK,QAAQ,EAAE,UAAU;QACpBO,MAAM,EAAE,IAAI;QACZhB,OAAO,EAAE,OAAO;QAChBiC,UAAU,EAAE,SAAS;QACrBzK,OAAO,EAAE,GAAG;QACZhB,SAAS,EAAE,MAAM;QACjBC,YAAY,EAAE;MAClB,CAAE;MACF,wBAAqB,MAAM;MAC3B,gCAA6B;IAAM,GAElCqJ,iBAAiB,CAAC,CAAC,EACnBU,WAAW,CAAC,CACZ,CAAC,EACN/N,eACJ,CAAC;EACL;;EAEA;EACA,OACI3B,oDAAA;IACImQ,GAAG,EAAEtN,iBAAkB;IACvBoM,SAAS,EAAC,yBAAyB;IACnCxJ,KAAK,EAAE;MACHkK,QAAQ,EAAE,UAAU;MACpBO,MAAM,EAAErO,eAAe,GAAG,IAAI,GAAG,IAAI;MACrCqN,OAAO,EAAErN,eAAe,GAAG,OAAO,GAAG,MAAM;MAC3CsP,UAAU,EAAEtP,eAAe,GAAG,SAAS,GAAG,QAAQ;MAClD6E,OAAO,EAAE7E,eAAe,GAAG,GAAG,GAAG;IACrC,CAAE;IACF,wBAAqB,MAAM;IAC3B,gCAA8BA,eAAe,GAAG,MAAM,GAAG;EAAQ,GAEhEmN,iBAAiB,CAAC,CAAC,EACnBU,WAAW,CAAC,CACZ,CAAC;AAEd,CAAC;AAED,iEAAerP,aAAa;;;;;;;;;;AClsC5B;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;;;;;ACAA;;;;;;UCAA;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;;;;WCtBA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA;;;;;WCPA;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D;;;;;;;;;;;;;;;;;;;;;ACNqC;AACe;AACR;AACA;AAE5C,MAAMkR,oBAAoB,GAAGA,CAAA,KAAM;EAC/B,MAAM;IAAE7N;EAAwB,CAAC,GAAG4N,0DAAS,CAAE5J,MAAM,IAAK;IACtD,MAAM8J,KAAK,GAAG9J,MAAM,CAAC,eAAe,CAAC;IACrC,IAAI,CAAC8J,KAAK,EAAE;MACR,OAAO;QAAE9N,uBAAuB,EAAE;MAAM,CAAC;IAC7C;;IAEA;IACA,MAAM+N,aAAa,GAAGD,KAAK,CAACE,gBAAgB,CAAC,CAAC;;IAE9C;IACA,MAAMC,YAAY,GAAGF,aAAa,GAAG,CAAC,CAAC,EAAEG,cAAc,EAAEC,IAAI,CAACC,IAAI,IAAIA,IAAI,CAACC,QAAQ,CAAC;IAEpF,OAAO;MACHrO,uBAAuB,EAAEiO,YAAY,EAAEK,SAAS,KAAK;IACzD,CAAC;EACL,CAAC,EAAE,EAAE,CAAC;EAEN,IAAI,CAACtO,uBAAuB,EAAE;IAC1B,OAAO,IAAI;EACf;EAEA,OAAO1D,oDAAA,CAACK,sDAAa,MAAE,CAAC;AAC5B,CAAC;AAED4R,OAAO,CAACC,GAAG,CAAC,yCAAyC,CAAC;AAEtDb,kEAAc,CAAC,sBAAsB,EAAE;EACnCc,MAAM,EAAEZ,oBAAoB;EAC5Ba,KAAK,EAAE;AACX,CAAC,CAAC,C","sources":["webpack://deliver-with-econt-woc-blocks/./src/blocks/checkout/EcontDelivery.js","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"data\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"i18n\"]","webpack://deliver-with-econt-woc-blocks/external window [\"wp\",\"plugins\"]","webpack://deliver-with-econt-woc-blocks/external window \"React\"","webpack://deliver-with-econt-woc-blocks/external window \"ReactDOM\"","webpack://deliver-with-econt-woc-blocks/webpack/bootstrap","webpack://deliver-with-econt-woc-blocks/webpack/runtime/compat get default export","webpack://deliver-with-econt-woc-blocks/webpack/runtime/define property getters","webpack://deliver-with-econt-woc-blocks/webpack/runtime/hasOwnProperty shorthand","webpack://deliver-with-econt-woc-blocks/webpack/runtime/make namespace object","webpack://deliver-with-econt-woc-blocks/./src/blocks/checkout/index.js"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, useRef } from \"react\"\nimport { createPortal } from \"react-dom\"\n\nconst EcontDelivery = () => {\n    // Declare jQuery and wp variables\n    const jQuery = window.jQuery\n    const wp = window.wp\n\n    // Component state\n    const [iframeUrl, setIframeUrl] = useState(\"\")\n    const [globalShipmentPrices, setGlobalShipmentPrices] = useState({\n        cod: undefined,\n        cod_e: undefined,\n        no_cod: undefined,\n    })\n    const [globalInfoMessage, setGlobalInfoMessage] = useState(\"\")\n    const [isModalOpen, setIsModalOpen] = useState(false)\n    const [isLoading, setIsLoading] = useState(false)\n    const [useShipping, setUseShipping] = useState(true)\n    const [buttonContainer, setButtonContainer] = useState(null)\n    const [portalContainer, setPortalContainer] = useState(null)\n    const [isEcontSelected, setIsEcontSelected] = useState(false)\n    const [globalAlertMessage, setGlobalAlertMessage] = useState(false)\n    const [cartTotal, setCartTotal] = useState(0)\n    const [cartWeight, setCartWeight] = useState(1) // Default weight of 1kg\n    const [checkoutButtonDisabled, setCheckoutButtonDisabled] = useState(false)\n    const [isOrderButtonDisabled, setIsOrderButtonDisabled] = useState(false)\n    const [currentShippingMethod, setCurrentShippingMethod] = useState(\"\")\n\n    // Refs\n    const isMountedRef = useRef(true)\n    const messageListenerRef = useRef(null)\n    const econtContainerRef = useRef(null)\n    const modalRef = useRef(null)\n\n    // Get locale for button text\n    const locale = document.documentElement.lang.split(\"-\")[0] || \"en\"\n    const buttonText = locale === \"bg\" ? \"Редактирай данни\" : \"Edit details\"\n    const selectLocationText = locale === \"bg\" ? \"Изчисли цена за доставка\" : \"Calculate shipping price\"\n\n    // Function to reset cookies and state\n    const resetCookies = () => {\n        document.cookie = \"econt_shippment_price=0; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;\"\n        document.cookie = \"econt_customer_info_id=0; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT;\"\n\n        setGlobalShipmentPrices({\n            cod: undefined,\n            cod_e: undefined,\n            no_cod: undefined,\n        })\n        setGlobalInfoMessage(\"\")\n    }\n\n    // Function to validate shipping price\n    const validateShippingPrice = (e) => {\n        if (\n            isEcontShippingSelected() &&\n            (globalShipmentPrices.cod === undefined ||\n                globalShipmentPrices.cod_e === undefined ||\n                globalShipmentPrices.no_cod === undefined)\n        ) {\n            e.preventDefault()\n            e.stopPropagation()\n\n            if (globalAlertMessage) {\n                wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n                setGlobalAlertMessage(false)\n                return\n            }\n\n            alert(locale === \"bg\" ? \"Моля калкулирайте цена за доставка с Еконт!\" : \"Please calculate Econt shipping price!\")\n            wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n            setGlobalAlertMessage(true)\n            return false\n        }\n    }\n\n    // Function to check if Econt shipping is selected\n    const isEcontShippingSelected = () => {\n        // Try multiple selectors to find the Econt radio button\n        const selectors = [\n            'input[value=\"delivery_with_econt\"]',\n            'input[id*=\"delivery_with_econt\"]',\n            'input[name^=\"shipping_method\"][value*=\"econt\"]',\n            'input[name^=\"shipping_method\"][id*=\"econt\"]',\n        ]\n\n        for (const selector of selectors) {\n            const econtRadio = document.querySelector(selector)\n            if (econtRadio) {\n                if (econtRadio.type === \"radio\" && econtRadio.checked) {\n                    return true\n                } else if (econtRadio.type === \"hidden\") {\n                    return true\n                }\n            }\n        }\n\n        // Also check if we have a shipping method with \"econt\" in the value\n        if (typeof jQuery !== \"undefined\") {\n            const shippingMethod = jQuery('input[name^=\"shipping_method\"]:checked').val()\n            if (shippingMethod && shippingMethod.includes(\"econt\")) {\n                return true\n            }\n        }\n\n        return false\n    }\n\n    // Function to get current shipping method\n    const getCurrentShippingMethod = () => {\n        if (typeof jQuery !== \"undefined\") {\n            const shippingMethod = jQuery('input[name^=\"shipping_method\"]:checked').val() || \"\"\n            return shippingMethod\n        }\n        return \"\"\n    }\n\n    // Function to check if a payment method is selected\n    const isPaymentMethodSelected = (paymentMethodId) => {\n        const paymentMethod = document.getElementById(paymentMethodId)\n        if (paymentMethod) {\n            if (paymentMethod.type === \"radio\" && paymentMethod.checked) {\n                return true\n            } else if (paymentMethod.type === \"hidden\") {\n                return true\n            }\n        }\n        return false\n    }\n\n    // Function to find the shipping option container\n    const findShippingOptionContainer = () => {\n        const selectors = [\n            \"#shipping-option\",\n            \".wc-block-components-shipping-rates-control\",\n            \".shipping_method\",\n            \".woocommerce-shipping-methods\",\n            \"#shipping_method\",\n        ]\n\n        for (const selector of selectors) {\n            const element = document.querySelector(selector)\n            if (element) {\n                return element\n            }\n        }\n\n        return null\n    }\n\n    // Function to find the Econt radio button label\n    const findEcontRadioLabel = () => {\n        // Look for the Econt radio button\n        const econtRadio = document.querySelector('input[value=\"delivery_with_econt\"]')\n        if (econtRadio) {\n            // Find the parent label element\n            const label = econtRadio.closest(\"label\")\n            return label\n        }\n        return null\n    }\n\n    // Function to create a button container next to the Econt radio\n    const createButtonContainerNextToEcontRadio = () => {\n        if (!isMountedRef.current) return null\n\n        // Find the Econt radio label\n        const econtLabel = findEcontRadioLabel()\n        if (!econtLabel) return null\n\n        // Check if we already have a button container\n        let container = document.getElementById(\"econt-button-container\")\n\n        // If no container exists, create one\n        if (!container) {\n            container = document.createElement(\"div\")\n            container.id = \"econt-button-container\"\n            container.style.marginTop = \"16px\"\n            container.style.marginBottom = \"16px\" // Indent to align with radio button\n            container.style.marginLeft = \"24px\" // Indent to align with radio button\n            container.style.marginRight = \"24px\" // Indent to align with radio button\n\n            // Insert after the Econt radio label\n            if (econtLabel.nextSibling) {\n                econtLabel.parentNode.insertBefore(container, econtLabel.nextSibling)\n            } else {\n                econtLabel.parentNode.appendChild(container)\n            }\n        }\n\n        return container\n    }\n\n    // Function to create a portal container after shipping options\n    const createPortalContainerAfterShippingOption = () => {\n        if (!isMountedRef.current) return null\n\n        // Find the shipping option element\n        const targetElement = findShippingOptionContainer()\n        if (!targetElement) return null\n\n        // Check if we already have a portal container\n        let container = document.getElementById(\"econt-portal-container\")\n\n        // If no container exists, create one\n        if (!container) {\n            container = document.createElement(\"div\")\n            container.id = \"econt-portal-container\"\n\n            // Insert after the shipping option\n            if (targetElement.nextSibling) {\n                targetElement.parentNode.insertBefore(container, targetElement.nextSibling)\n            } else {\n                targetElement.parentNode.appendChild(container)\n            }\n        }\n\n        return container\n    }\n\n    // Function to disable/enable the place order button\n    const togglePlaceOrderButton = (disable) => {\n        // Update React state first\n        setIsOrderButtonDisabled(disable)\n\n        // Try to find the button using multiple selectors\n        const buttonSelectors = [\n            \".wc-block-components-checkout-place-order-button\",\n            \"#place_order\",\n            \"button[name='woocommerce_checkout_place_order']\",\n            \".checkout-button\",\n            \"button.alt\",\n        ]\n\n        let buttonFound = false\n\n        // Try direct DOM manipulation first\n        for (const selector of buttonSelectors) {\n            const button = document.querySelector(selector)\n            if (button) {\n                buttonFound = true\n                button.disabled = disable\n\n                if (disable) {\n                    button.style.opacity = \"0.5\"\n                    button.style.cursor = \"not-allowed\"\n                } else {\n                    button.style.opacity = \"\"\n                    button.style.cursor = \"\"\n                }\n\n            }\n        }\n\n        // Also try with jQuery for better compatibility\n        if (typeof jQuery !== \"undefined\") {\n            for (const selector of buttonSelectors) {\n                const $button = jQuery(selector)\n                if ($button.length) {\n                    buttonFound = true\n\n                    if (disable) {\n                        $button.prop(\"disabled\", true)\n                        $button.addClass(\"disabled\")\n                        $button.css({\n                            opacity: \"0.5\",\n                            cursor: \"not-allowed\",\n                        })\n                    } else {\n                        $button.prop(\"disabled\", false)\n                        $button.removeClass(\"disabled\")\n                        $button.css({\n                            opacity: \"1\",\n                            cursor: \"pointer\",\n                        })\n                    }\n\n                }\n            }\n        }\n\n    }\n\n    // Function to create a modal container\n    const createModalContainer = () => {\n        if (!isMountedRef.current) return null\n\n        // Check if we already have a modal container\n        let container = document.getElementById(\"econt-modal-container\")\n\n        // If no container exists, create one\n        if (!container) {\n            container = document.createElement(\"div\")\n            container.id = \"econt-modal-container\"\n            document.body.appendChild(container)\n        }\n\n        return container\n    }\n\n    // Function to check form fields before opening modal\n    const checkForm = (useShipping) => {\n        const fields = [\n            `#${useShipping ? \"shipping\" : \"billing\"}-first_name`,\n            `#${useShipping ? \"shipping\" : \"billing\"}-last_name`,\n            `#${useShipping ? \"shipping\" : \"billing\"}-country`,\n            `#${useShipping ? \"shipping\" : \"billing\"}-address_1`,\n            `#${useShipping ? \"shipping\" : \"billing\"}-city`,\n            `#${useShipping ? \"shipping\" : \"billing\"}-state`,\n            `#${useShipping ? \"shipping\" : \"billing\"}-postcode`,\n            \"#billing-phone\",\n            \"#email\",\n        ]\n\n        let showModal = true\n\n        fields.forEach((field) => {\n            if (typeof jQuery !== \"undefined\") {\n                if (jQuery(field).val() === \"\") {\n                    showModal = false\n                }\n            }\n        })\n\n        return showModal\n    }\n\n    // Function to get cart data from the new WooCommerce Store API\n    const getCartData = async () => {\n        try {\n            // Use the new WooCommerce Store API to get cart data\n            if (wp && wp.data && wp.data.select(\"wc/store/cart\")) {\n                const cartData = wp.data.select(\"wc/store/cart\").getCartData()\n\n                // console.log(cartData)\n                if (cartData) {\n                    // console.log(\"Cart data from Store API:\", cartData)\n\n                    // Get total price from cart data\n                    const total = cartData.totals?.total_items || 0\n                    setCartTotal(Number.parseFloat(total) / 100) // Convert from cents to currency units\n\n                    // Calculate total weight from cart items\n                    const totalWeight = cartData.itemsWeight * 0.001\n\n                    // console.log(\"Calculated total weight:\", totalWeight)\n\n                    // Set minimum weight of 1kg if calculated weight is less\n                    const finalWeight = totalWeight > 0 ? totalWeight : 1\n                    setCartWeight(finalWeight)\n\n                    return {\n                        total: Number.parseFloat(total) / 100,\n                        weight: finalWeight,\n                        currency: cartData.totals?.currency_code || \"BGN\",\n                    }\n                }\n            }\n\n            // Fallback to jQuery method if WP Store API is not available\n            if (typeof jQuery !== \"undefined\") {\n                const cartTotalElement = jQuery(\".order-total .amount\")\n                if (cartTotalElement.length) {\n                    const total =\n                        Number.parseFloat(\n                            cartTotalElement\n                                .text()\n                                .replace(/[^0-9,.]/g, \"\")\n                                .replace(\",\", \".\"),\n                        ) || 0\n                    setCartTotal(total)\n\n                    // Try to get weight from hidden input if available\n                    let weight = 1\n                    const weightInput = jQuery('input[name=\"cart_weight\"]')\n                    if (weightInput.length) {\n                        weight = Number.parseFloat(weightInput.val()) || 1\n                        setCartWeight(weight)\n                    }\n\n                    return { total, weight, currency: \"BGN\" }\n                }\n            }\n\n            return { total: 0, weight: 1, currency: \"BGN\" }\n        } catch (error) {\n            return { total: 0, weight: 1, currency: \"BGN\" }\n        }\n    }\n\n    // Function to get data from form and make AJAX request\n    const getDataFromForm = async () => {\n\n        if (!isMountedRef.current) {\n            return\n        }\n\n        if (!isEcontShippingSelected()) {\n            return\n        }\n\n        // Start loading\n        setIsLoading(true)\n\n        // Create modal container in advance\n        const modalContainer = createModalContainer()\n\n        // Get customer data from form\n        const prefix = useShipping ? \"shipping\" : \"billing\"\n        const customerData = {\n            first_name: document.getElementById(`${prefix}-first_name`)?.value || \"\",\n            last_name: document.getElementById(`${prefix}-last_name`)?.value || \"\",\n            company: document.getElementById(`${prefix}-company`)?.value || \"\",\n            address_1: document.getElementById(`${prefix}-address_1`)?.value || \"\",\n            city: document.getElementById(`${prefix}-city`)?.value || \"\",\n            postcode: document.getElementById(`${prefix}-postcode`)?.value || \"\",\n            phone: document.getElementById(`${prefix}-phone`)?.value || \"\",\n            email: document.getElementById(\"email\")?.value || \"\",\n        }\n\n        // Prepare request params\n        const params = {\n            customer_name: `${customerData.first_name} ${customerData.last_name}`.trim(),\n            customer_company: customerData.company,\n            customer_address: customerData.address_1,\n            customer_city_name: customerData.city,\n            customer_post_code: customerData.postcode,\n            customer_phone: customerData.phone,\n            customer_email: customerData.email,\n        }\n\n        // Get cart data from the new WooCommerce Store API\n        const cartData = await getCartData()\n\n        // Extend params with cart data\n        const extendedParams = {\n            ...params,\n            order_total: cartData.total,\n            order_currency: cartData.currency,\n            pack_count: 1,\n            order_weight: cartData.weight, // Use the calculated weight from cart items\n        }\n\n        // Remove empty values\n        Object.keys(params).forEach((key) => {\n            if (!params[key]) delete params[key]\n        })\n\n        try {\n            // Make AJAX request\n            if (typeof jQuery !== \"undefined\") {\n\n                if (!window.econtData) {\n                    setIsLoading(false)\n                    return\n                }\n\n                const response = await jQuery.ajax({\n                    type: \"POST\",\n                    url: window.econtData.ajaxUrl,\n                    data: {\n                        action: \"woocommerce_delivery_with_econt_get_orderinfo\",\n                        security: window.econtData.nonce,\n                        params: extendedParams,\n                    },\n                })\n\n                if (!response) {\n                    setIsLoading(false)\n                    return\n                }\n\n                // Process URL\n                let url\n                if (typeof response === \"string\") {\n                    url = response.split('\"').join(\"\").replace(/\\\\\\//g, \"/\")\n                } else if (typeof response === \"object\") {\n                    url = response.toString()\n                } else {\n                    setIsLoading(false)\n                    return\n                }\n\n                // Set locale and build full URL\n                const validLocales = [\"bg\", \"en\", \"gr\", \"ro\"]\n                const fullUrl = `${url}&lang=${validLocales.includes(locale) ? locale : \"bg\"}`\n\n                // Update iframe with URL\n                setIframeUrl(fullUrl)\n\n                // Open the modal\n                setIsModalOpen(true)\n\n                // Stop loading after a short delay\n                setTimeout(() => {\n                    setIsLoading(false)\n                }, 1000)\n            } else {\n                setIsLoading(false)\n            }\n        } catch (error) {\n            setIsLoading(false)\n        }\n    }\n\n    // Handle postMessage events from iframe\n    const handleIframeMessage = async (event) => {\n        // Check if message is from Econt\n        const econtServiceUrl = document.querySelector('meta[name=\"econt-service-url\"]')?.content\n        if (econtServiceUrl && econtServiceUrl.indexOf(event.origin) < 0) {\n            return\n        }\n\n        const data = event.data\n\n        // Reset alert message flag\n        setGlobalAlertMessage(false)\n\n        // Handle error message\n        if (data.shipment_error && data.shipment_error !== \"\") {\n            if (typeof jQuery !== \"undefined\") {\n                // jQuery(\"#econt_display_error_message\").empty()\n                alert(data.shipment_error)\n                // jQuery(\".econt-alert\").addClass(\"active\")\n\n                // jQuery(\"html,body\").animate(\n                //     { scrollTop: jQuery(\"#delivery_with_econt_calculate_shipping\").offset().top - 50 },\n                //     750,\n                // )\n\n                // setTimeout(() => {\n                //     jQuery(\".econt-alert\").removeClass(\"active\")\n                // }, 3500)\n            }\n            return false\n        }\n\n        // Store shipment prices\n        setGlobalShipmentPrices({\n            cod: data.shipping_price_cod,\n            cod_e: data.shipping_price_cod_e,\n            no_cod: data.shipping_price,\n        })\n\n        // Determine current shipping price based on payment method\n        let shipmentPrice = data.shipping_price\n        const codInput = document.getElementById(\"payment_method_cod\")\n        const econtPaymentInput = document.getElementById(\"payment_method_econt_payment\")\n\n        if (codInput && codInput.checked) {\n            shipmentPrice = data.shipping_price_cod\n        } else if (econtPaymentInput && econtPaymentInput.checked) {\n            shipmentPrice = data.shipping_price_cod_e\n        }\n\n        // Set info message\n        const infoMessage = `${data.shipping_price} ${data.shipping_price_currency_sign} за доставка и ${\n            Math.round((shipmentPrice - data.shipping_price) * 100) / 100\n        } ${data.shipping_price_currency_sign} наложен платеж.`\n\n        setGlobalInfoMessage(infoMessage)\n\n        // Set cookie\n        document.cookie = `econt_shippment_price=${shipmentPrice}; path=/`\n\n        // Close modal\n        setIsModalOpen(false)\n\n        // Update form fields\n        const prefix = useShipping ? \"shipping\" : \"billing\"\n        let fullName = []\n        let company = \"\"\n\n        if (data.face != null) {\n            fullName = data.face.split(\" \")\n            company = data.name\n        } else {\n            fullName = data.name.split(\" \")\n        }\n\n        // // Update form fields\n        // if (document.getElementById(`${prefix}_first_name`))\n        //     document.getElementById(`${prefix}_first_name`).value = fullName[0] ? fullName[0] : \"\"\n        //\n        // if (document.getElementById(`${prefix}_last_name`))\n        //     document.getElementById(`${prefix}_last_name`).value = fullName[1] ? fullName[1] : \"\"\n        //\n        // if (document.getElementById(`${prefix}_company`)) document.getElementById(`${prefix}_company`).value = company\n        //\n        // if (document.getElementById(`${prefix}_address_1`))\n        //     document.getElementById(`${prefix}_address_1`).value = data.address != \"\" ? data.address : data.office_name\n        //\n        // if (document.getElementById(`${prefix}_city`)) document.getElementById(`${prefix}_city`).value = data.city_name\n        //\n        // if (document.getElementById(`${prefix}_postcode`))\n        //     document.getElementById(`${prefix}_postcode`).value = data.post_code\n        //\n        // if (document.getElementById(\"billing_phone\")) document.getElementById(\"billing_phone\").value = data.phone\n        //\n        // if (document.getElementById(\"billing_email\")) document.getElementById(\"billing_email\").value = data.email\n\n        // Set customer info ID cookie\n        document.cookie = `econt_customer_info_id=${data.id}; path=/`\n\n        // Trigger checkout update\n        wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n\n        // Enable the place order button now that we have shipping data\n        togglePlaceOrderButton(false) // Use the function to ensure state is updated too\n    }\n\n    // Function to show price info\n    const showPriceInfo = () => {\n        if (typeof jQuery !== \"undefined\") {\n            const infoElement = jQuery(\"#econt_detailed_shipping\")\n            infoElement.empty()\n\n            if (!isEcontShippingSelected()) {\n                infoElement.css(\"display\", \"none\")\n            } else {\n                if (isPaymentMethodSelected(\"payment_method_cod\")) {\n                    infoElement.text(globalInfoMessage)\n                } else if (isPaymentMethodSelected(\"payment_method_econt_payment\")) {\n                    infoElement.text(\"\")\n                } else {\n                    infoElement.text(\"\")\n                }\n                infoElement.css(\"display\", \"block\")\n            }\n        }\n    }\n\n    // Function to update checkout button state\n    const updateCheckoutButtonState = (disabled) => {\n        if (typeof jQuery !== \"undefined\") {\n            const placeOrderButton = jQuery(\"#place_order\")\n\n            if (placeOrderButton.length) {\n                if (disabled) {\n                    // Disable the button\n                    placeOrderButton.prop(\"disabled\", true)\n                    placeOrderButton.addClass(\"disabled\")\n                    placeOrderButton.css({\n                        opacity: \"0.5\",\n                        cursor: \"not-allowed\",\n                    })\n\n                    // Add a tooltip or message\n                    if (!jQuery(\"#econt-shipping-warning\").length) {\n                        const warningMessage =\n                            locale === \"bg\"\n                                ? \"Моля калкулирайте цена за доставка с Еконт преди да продължите!\"\n                                : \"Please calculate Econt shipping price before proceeding!\"\n\n                        placeOrderButton.after(\n                            `<div id=\"econt-shipping-warning\" style=\"color: #e2401c; margin-top: 10px;\">${warningMessage}</div>`,\n                        )\n                    }\n                } else {\n                    // Enable the button\n                    placeOrderButton.prop(\"disabled\", false)\n                    placeOrderButton.removeClass(\"disabled\")\n                    placeOrderButton.css({\n                        opacity: \"1\",\n                        cursor: \"pointer\",\n                    })\n\n                    // Remove the warning message\n                    jQuery(\"#econt-shipping-warning\").remove()\n                }\n            }\n        }\n    }\n\n    // Function to check shipping method and update UI accordingly\n    const checkShippingMethod = () => {\n        // Get current shipping method\n        const newShippingMethod = getCurrentShippingMethod()\n        const isEcont = isEcontShippingSelected()\n\n        // Update state with current selection\n        setIsEcontSelected(isEcont)\n        setCurrentShippingMethod(newShippingMethod)\n\n        if (isEcont) {\n            // Create portal container if needed\n            const container = createPortalContainerAfterShippingOption()\n            if (container) {\n                setPortalContainer(container)\n            }\n\n            // Create button container if needed\n            const btnContainer = createButtonContainerNextToEcontRadio()\n            if (btnContainer) {\n                setButtonContainer(btnContainer)\n            }\n\n            // Get cart data when Econt is selected\n            getCartData()\n\n            // Check if we need to disable the checkout button\n            const shouldDisableButton =\n                globalShipmentPrices.cod === undefined ||\n                globalShipmentPrices.cod_e === undefined ||\n                globalShipmentPrices.no_cod === undefined\n\n            // Disable place order button until shipping data is received\n            togglePlaceOrderButton(shouldDisableButton)\n        } else {\n            // If Econt is not selected, make sure the button is enabled\n            togglePlaceOrderButton(false)\n        }\n    }\n\n    // Effect to monitor shipping method changes\n    useEffect(() => {\n        // Initial check\n        checkShippingMethod()\n\n        // Set up event listeners for shipping method changes\n        const handleShippingMethodChange = () => {\n            checkShippingMethod()\n\n            // Double-check after a short delay to ensure changes are applied\n            setTimeout(checkShippingMethod, 100)\n            setTimeout(checkShippingMethod, 500)\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            // Listen for checkout updates\n            jQuery(document.body).on(\"updated_checkout\", handleShippingMethodChange)\n\n            // Listen for shipping method radio changes\n            jQuery(document).on(\"change\", 'input[name^=\"shipping_method\"]', handleShippingMethodChange)\n\n            // Also check when any input changes (broader approach)\n            jQuery(document).on(\"change\", \"input\", () => {\n                setTimeout(checkShippingMethod, 100)\n            })\n        }\n\n        // Also check periodically for the first few seconds\n        const intervalId = setInterval(checkShippingMethod, 1000)\n        setTimeout(() => clearInterval(intervalId), 2000)\n\n        // Clean up event listeners\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\", handleShippingMethodChange)\n                jQuery(document).off(\"change\", 'input[name^=\"shipping_method\"]', handleShippingMethodChange)\n                jQuery(document).off(\"change\", \"input\")\n            }\n            clearInterval(intervalId)\n        }\n    }, [globalShipmentPrices])\n\n    // Dedicated effect to handle shipping method changes\n    useEffect(() => {\n\n        // If not using Econt, ensure button is enabled\n        if (!currentShippingMethod.includes(\"econt\")) {\n\n            // Enable button with a slight delay to ensure it happens after any other code\n            setTimeout(() => togglePlaceOrderButton(false), 200)\n            setTimeout(() => togglePlaceOrderButton(false), 500)\n        }\n    }, [currentShippingMethod])\n\n    // Add a call to debugCartData in the useEffect that handles cart data changes\n    // Find the useEffect with handleCartDataChange and add this line at the beginning of the function:\n    // Replace the cart data change effect with this updated version\n    useEffect(() => {\n        // Function to handle cart data changes\n        const handleCartDataChange = () => {\n            if (isEcontSelected) {\n                // Debug cart data structure to find weight information\n                // debugCartData()\n                getCartData()\n            }\n        }\n\n        // Set up subscription to cart data changes\n        let unsubscribe\n        if (wp && wp.data && wp.data.subscribe) {\n            unsubscribe = wp.data.subscribe(() => {\n                const newCartData = wp.data.select(\"wc/store/cart\")?.getCartData()\n                if (newCartData) {\n                    handleCartDataChange()\n                }\n            })\n        }\n\n        // Initial debug and data fetch\n        if (isEcontSelected) {\n            // debugCartData()\n            getCartData()\n        }\n\n        // Clean up subscription\n        return () => {\n            if (unsubscribe) {\n                unsubscribe()\n            }\n        }\n    }, [isEcontSelected])\n\n    // Effect to update portal container when shipping method changes\n    useEffect(() => {\n        if (isEcontSelected) {\n            const container = createPortalContainerAfterShippingOption()\n            if (container) {\n                setPortalContainer(container)\n            }\n\n            const btnContainer = createButtonContainerNextToEcontRadio()\n            if (btnContainer) {\n                setButtonContainer(btnContainer)\n            }\n\n            // Show price info\n            showPriceInfo()\n\n            // Check if we need to disable the checkout button\n            const shouldDisableButton =\n                globalShipmentPrices.cod === undefined ||\n                globalShipmentPrices.cod_e === undefined ||\n                globalShipmentPrices.no_cod === undefined\n\n            setCheckoutButtonDisabled(shouldDisableButton)\n            updateCheckoutButtonState(shouldDisableButton)\n        }\n    }, [isEcontSelected, globalInfoMessage])\n\n    // Effect to set up message event listener\n    useEffect(() => {\n        messageListenerRef.current = handleIframeMessage\n        window.addEventListener(\"message\", handleIframeMessage)\n\n        return () => {\n            window.removeEventListener(\"message\", handleIframeMessage)\n            messageListenerRef.current = null\n        }\n    }, [useShipping])\n\n    // Effect to handle modal close on escape key\n    useEffect(() => {\n        const handleEscapeKey = (e) => {\n            if (e.key === \"Escape\" && isModalOpen) {\n                setIsModalOpen(false)\n            }\n        }\n\n        document.addEventListener(\"keydown\", handleEscapeKey)\n\n        return () => {\n            document.removeEventListener(\"keydown\", handleEscapeKey)\n        }\n    }, [isModalOpen])\n\n    // Effect to handle click outside modal to close\n    useEffect(() => {\n        const handleClickOutside = (e) => {\n            if (modalRef.current && !modalRef.current.contains(e.target) && isModalOpen) {\n                // Check if the click is on the modal overlay (background)\n                if (e.target.classList.contains(\"econt-modal-overlay\")) {\n                    setIsModalOpen(false)\n                }\n            }\n        }\n\n        document.addEventListener(\"mousedown\", handleClickOutside)\n\n        return () => {\n            document.removeEventListener(\"mousedown\", handleClickOutside)\n        }\n    }, [isModalOpen])\n\n    // Effect to handle payment method changes\n    useEffect(() => {\n        const handlePaymentMethodChange = () => {\n            if (typeof jQuery !== \"undefined\") {\n                const paymentInputs = jQuery('input[name^=\"payment_method\"]')\n\n                paymentInputs.each((key, field) => {\n                    jQuery(`#${field.id}`).change(function () {\n                        if (this.value === \"cod\" && isEcontShippingSelected()) {\n                            document.cookie = `econt_shippment_price=${globalShipmentPrices.cod}; path=/`\n                            jQuery(\"#econt_detailed_shipping\").css(\"display\", \"block\")\n                        } else if (this.value === \"econt_payment\" && isEcontShippingSelected()) {\n                            document.cookie = `econt_shippment_price=${globalShipmentPrices.cod_e}; path=/`\n                            jQuery(\"#econt_detailed_shipping\").css(\"display\", \"block\")\n                        } else if (isEcontShippingSelected()) {\n                            document.cookie = `econt_shippment_price=${globalShipmentPrices.no_cod}; path=/`\n                            jQuery(\"#econt_detailed_shipping\").css(\"display\", \"none\")\n                        }\n\n                        wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n                    })\n                })\n            }\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            jQuery(document.body).on(\"updated_checkout\", handlePaymentMethodChange)\n        }\n\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\", handlePaymentMethodChange)\n            }\n        }\n    }, [globalShipmentPrices])\n\n    // Effect to handle place order button click\n    useEffect(() => {\n        const handlePlaceOrderClick = (e) => {\n            validateShippingPrice(e)\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            jQuery(\"#place_order\").on(\"click\", handlePlaceOrderClick)\n        }\n\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(\"#place_order\").off(\"click\", handlePlaceOrderClick)\n            }\n        }\n    }, [globalShipmentPrices])\n\n    // Effect to handle coupon changes\n    useEffect(() => {\n        const handleCouponChange = () => {\n            resetCookies()\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            jQuery(\"button[name='apply_coupon']\").on(\"click\", handleCouponChange)\n            jQuery(\"a.woocommerce-remove-coupon\").on(\"click\", handleCouponChange)\n        }\n\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(\"button[name='apply_coupon']\").off(\"click\", handleCouponChange)\n                jQuery(\"a.woocommerce-remove-coupon\").off(\"click\", handleCouponChange)\n            }\n        }\n    }, [])\n\n    // Effect to handle checkout errors\n    useEffect(() => {\n        const handleCheckoutError = () => {\n            resetCookies()\n            wp.data.dispatch(\"wc/store/cart\").invalidateResolutionForStoreSelector(\"getCartData\")\n        }\n\n        if (typeof jQuery !== \"undefined\") {\n            jQuery(document.body).on(\"checkout_error\", handleCheckoutError)\n        }\n\n        return () => {\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"checkout_error\", handleCheckoutError)\n            }\n        }\n    }, [])\n\n    // Effect to clean up on unmount\n    useEffect(() => {\n        return () => {\n            isMountedRef.current = false\n\n            // Clean up any event listeners\n            if (typeof jQuery !== \"undefined\") {\n                jQuery(document.body).off(\"updated_checkout\")\n                jQuery('input[name^=\"shipping_method\"]').off(\"change\")\n                jQuery(\"#place_order\").off(\"click\")\n                jQuery(\"button[name='apply_coupon']\").off(\"click\")\n                jQuery(\"a.woocommerce-remove-coupon\").off(\"click\")\n                jQuery(document.body).off(\"checkout_error\")\n            }\n\n            // Remove message event listener\n            if (messageListenerRef.current) {\n                window.removeEventListener(\"message\", messageListenerRef.current)\n                messageListenerRef.current = null\n            }\n\n            // Remove portal container\n            const container = document.getElementById(\"econt-portal-container\")\n            if (container) {\n                container.remove()\n            }\n\n            // Remove button container\n            const btnContainer = document.getElementById(\"econt-button-container\")\n            if (btnContainer) {\n                btnContainer.remove()\n            }\n\n            // Remove modal container\n            const modalContainer = document.getElementById(\"econt-modal-container\")\n            if (modalContainer) {\n                modalContainer.remove()\n            }\n        }\n    }, [])\n\n    // Render the button next to Econt radio\n    const renderEcontButton = () => {\n        if (!isEcontSelected) {\n            return null\n        }\n\n        // Create button container if it doesn't exist\n        const btnContainer = buttonContainer || createButtonContainerNextToEcontRadio()\n        if (!btnContainer) {\n            return null\n        }\n\n        // Set button container state if needed\n        if (btnContainer !== buttonContainer) {\n            setButtonContainer(btnContainer)\n        }\n\n        return createPortal(\n            <button\n                type=\"button\"\n                id=\"calculate_shipping_button\"\n                className=\"econt-button econt-button-select\"\n                style={{\n                    display: \"inline-block\",\n                    padding: \"8px 16px\",\n                    backgroundColor: \"#0066cc\",\n                    color: \"white\",\n                    border: \"none\",\n                    borderRadius: \"4px\",\n                    cursor: \"pointer\",\n                    fontSize: \"14px\",\n                    marginTop: \"8px\",\n                }}\n                onClick={() => {\n                    getDataFromForm()\n                }}\n            >\n                {globalShipmentPrices.no_cod ? buttonText : selectLocationText}\n            </button>,\n            btnContainer,\n        )\n    }\n\n    // Render the modal\n    const renderModal = () => {\n        if (!isModalOpen) return null\n\n        const modalContainer = createModalContainer()\n        if (!modalContainer) return null\n\n        return createPortal(\n            <div\n                id=\"myModal\"\n                className=\"econt-modal-overlay\"\n                style={{\n                    position: \"fixed\",\n                    top: 0,\n                    left: 0,\n                    right: 0,\n                    bottom: 0,\n                    backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n                    display: \"flex\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                    zIndex: 9999,\n                }}\n            >\n                <div\n                    ref={modalRef}\n                    className=\"econt-modal\"\n                    style={{\n                        backgroundColor: \"white\",\n                        borderRadius: \"8px\",\n                        boxShadow: \"0 4px 12px rgba(0, 0, 0, 0.15)\",\n                        width: \"90%\",\n                        maxWidth: \"900px\",\n                        maxHeight: \"90vh\",\n                        display: \"flex\",\n                        flexDirection: \"column\",\n                        overflow: \"hidden\",\n                    }}\n                >\n                    <div\n                        className=\"econt-modal-header\"\n                        style={{\n                            display: \"flex\",\n                            justifyContent: \"space-between\",\n                            alignItems: \"center\",\n                            padding: \"16px 24px\",\n                            borderBottom: \"1px solid #eee\",\n                        }}\n                    >\n                        <h3 style={{ margin: 0 }}>{locale === \"bg\" ? \"Доставка с Еконт\" : \"Econt Delivery\"}</h3>\n                        <button\n                            type=\"button\"\n                            className=\"econt-modal-close\"\n                            style={{\n                                background: \"none\",\n                                border: \"none\",\n                                cursor: \"pointer\",\n                                fontSize: \"24px\",\n                                padding: \"4px\",\n                                lineHeight: \"1\",\n                            }}\n                            onClick={() => setIsModalOpen(false)}\n                            aria-label=\"Close\"\n                        >\n                            &times;\n                        </button>\n                    </div>\n                    <div\n                        className=\"econt-modal-body\"\n                        style={{\n                            padding: \"24px\",\n                            overflow: \"auto\",\n                            flex: 1,\n                        }}\n                    >\n                        {/* Loading indicator */}\n                        {isLoading && (\n                            <div\n                                className=\"econt-loading\"\n                                style={{\n                                    padding: \"20px\",\n                                    backgroundColor: \"#f8f9fa\",\n                                    textAlign: \"center\",\n                                }}\n                            >\n                                {locale === \"bg\" ? \"Зареждане...\" : \"Loading...\"}\n                            </div>\n                        )}\n\n                        {/* Iframe container */}\n                        <div\n                            id=\"place_iframe_here\"\n                            style={{\n                                display: isLoading ? \"none\" : \"block\",\n                                zIndex: isLoading ? \"-1\" : \"1\",\n                            }}\n                        >\n                            {iframeUrl && (\n                                <iframe\n                                    src={iframeUrl}\n                                    id=\"delivery_with_econt_iframe\"\n                                    name=\"econt_iframe_form\"\n                                    scrolling=\"yes\"\n                                    style={{\n                                        width: \"100%\",\n                                        height: \"600px\",\n                                        border: \"none\",\n                                    }}\n                                />\n                            )}\n                        </div>\n                    </div>\n                </div>\n            </div>,\n            modalContainer,\n        )\n    }\n\n    // If we have a portal container and Econt is selected, render through portal\n    if (portalContainer && isEcontSelected) {\n        return createPortal(\n            <div\n                ref={econtContainerRef}\n                className=\"wp-block-econt-delivery\"\n                style={{\n                    position: \"relative\",\n                    zIndex: \"10\",\n                    display: \"block\",\n                    visibility: \"visible\",\n                    opacity: \"1\",\n                    marginTop: \"20px\",\n                    marginBottom: \"32px\",\n                }}\n                data-econt-component=\"true\"\n                data-econt-shipping-selected=\"true\"\n            >\n                {renderEcontButton()}\n                {renderModal()}\n            </div>,\n            portalContainer,\n        )\n    }\n\n    // Fallback render method if portal is not available\n    return (\n        <div\n            ref={econtContainerRef}\n            className=\"wp-block-econt-delivery\"\n            style={{\n                position: \"relative\",\n                zIndex: isEcontSelected ? \"10\" : \"-1\",\n                display: isEcontSelected ? \"block\" : \"none\",\n                visibility: isEcontSelected ? \"visible\" : \"hidden\",\n                opacity: isEcontSelected ? \"1\" : \"0\",\n            }}\n            data-econt-component=\"true\"\n            data-econt-shipping-selected={isEcontSelected ? \"true\" : \"false\"}\n        >\n            {renderEcontButton()}\n            {renderModal()}\n        </div>\n    )\n}\n\nexport default EcontDelivery\n\n","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"i18n\"];","module.exports = window[\"wp\"][\"plugins\"];","module.exports = window[\"React\"];","module.exports = window[\"ReactDOM\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { __ } from '@wordpress/i18n';\nimport { registerPlugin } from '@wordpress/plugins';\nimport { useSelect } from '@wordpress/data';\nimport EcontDelivery from './EcontDelivery';\n\nconst EcontShippingContent = () => {\n    const { isEcontShippingSelected } = useSelect((select) => {\n        const store = select('wc/store/cart');\n        if (!store) {\n            return { isEcontShippingSelected: false };\n        }\n\n        // Get shipping rates\n        const shippingRates = store.getShippingRates();\n\n        // Find selected shipping rate\n        const selectedRate = shippingRates?.[0]?.shipping_rates?.find(rate => rate.selected);\n\n        return {\n            isEcontShippingSelected: selectedRate?.method_id === 'delivery_with_econt'\n        };\n    }, []);\n\n    if (!isEcontShippingSelected) {\n        return null;\n    }\n\n    return <EcontDelivery />;\n};\n\nconsole.log('Registering Econt delivery block plugin');\n\nregisterPlugin('econt-delivery-block', {\n    render: EcontShippingContent,\n    scope: 'woocommerce-checkout'\n});"],"names":["createElement","useState","useEffect","useRef","createPortal","EcontDelivery","jQuery","window","wp","iframeUrl","setIframeUrl","globalShipmentPrices","setGlobalShipmentPrices","cod","undefined","cod_e","no_cod","globalInfoMessage","setGlobalInfoMessage","isModalOpen","setIsModalOpen","isLoading","setIsLoading","useShipping","setUseShipping","buttonContainer","setButtonContainer","portalContainer","setPortalContainer","isEcontSelected","setIsEcontSelected","globalAlertMessage","setGlobalAlertMessage","cartTotal","setCartTotal","cartWeight","setCartWeight","checkoutButtonDisabled","setCheckoutButtonDisabled","isOrderButtonDisabled","setIsOrderButtonDisabled","currentShippingMethod","setCurrentShippingMethod","isMountedRef","messageListenerRef","econtContainerRef","modalRef","locale","document","documentElement","lang","split","buttonText","selectLocationText","resetCookies","cookie","validateShippingPrice","e","isEcontShippingSelected","preventDefault","stopPropagation","data","dispatch","invalidateResolutionForStoreSelector","alert","selectors","selector","econtRadio","querySelector","type","checked","shippingMethod","val","includes","getCurrentShippingMethod","isPaymentMethodSelected","paymentMethodId","paymentMethod","getElementById","findShippingOptionContainer","element","findEcontRadioLabel","label","closest","createButtonContainerNextToEcontRadio","current","econtLabel","container","id","style","marginTop","marginBottom","marginLeft","marginRight","nextSibling","parentNode","insertBefore","appendChild","createPortalContainerAfterShippingOption","targetElement","togglePlaceOrderButton","disable","buttonSelectors","buttonFound","button","disabled","opacity","cursor","$button","length","prop","addClass","css","removeClass","createModalContainer","body","checkForm","fields","showModal","forEach","field","getCartData","select","cartData","total","totals","total_items","Number","parseFloat","totalWeight","itemsWeight","finalWeight","weight","currency","currency_code","cartTotalElement","text","replace","weightInput","error","getDataFromForm","modalContainer","prefix","customerData","first_name","value","last_name","company","address_1","city","postcode","phone","email","params","customer_name","trim","customer_company","customer_address","customer_city_name","customer_post_code","customer_phone","customer_email","extendedParams","order_total","order_currency","pack_count","order_weight","Object","keys","key","econtData","response","ajax","url","ajaxUrl","action","security","nonce","join","toString","validLocales","fullUrl","setTimeout","handleIframeMessage","event","econtServiceUrl","content","indexOf","origin","shipment_error","shipping_price_cod","shipping_price_cod_e","shipping_price","shipmentPrice","codInput","econtPaymentInput","infoMessage","shipping_price_currency_sign","Math","round","fullName","face","name","showPriceInfo","infoElement","empty","updateCheckoutButtonState","placeOrderButton","warningMessage","after","remove","checkShippingMethod","newShippingMethod","isEcont","btnContainer","shouldDisableButton","handleShippingMethodChange","on","intervalId","setInterval","clearInterval","off","handleCartDataChange","unsubscribe","subscribe","newCartData","addEventListener","removeEventListener","handleEscapeKey","handleClickOutside","contains","target","classList","handlePaymentMethodChange","paymentInputs","each","change","handlePlaceOrderClick","handleCouponChange","handleCheckoutError","renderEcontButton","className","display","padding","backgroundColor","color","border","borderRadius","fontSize","onClick","renderModal","position","top","left","right","bottom","justifyContent","alignItems","zIndex","ref","boxShadow","width","maxWidth","maxHeight","flexDirection","overflow","borderBottom","margin","background","lineHeight","flex","textAlign","src","scrolling","height","visibility","__","registerPlugin","useSelect","EcontShippingContent","store","shippingRates","getShippingRates","selectedRate","shipping_rates","find","rate","selected","method_id","console","log","render","scope"],"sourceRoot":""}